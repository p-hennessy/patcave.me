<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title>The Patcave</title>
    <link href="https://patcave.me/feed.xml" rel="self" />
    <link href="https://patcave.me" />
    <updated>2022-04-26T05:11:18-06:00</updated>
    <author>
        <name>Patrick Hennessy</name>
    </author>
    <id>https://patcave.me</id>

    <entry>
        <title>Disaster Averted</title>
        <author>
            <name>Patrick Hennessy</name>
        </author>
        <link href="https://patcave.me/tf2maps-infrastructure-overhaul-project/"/>
        <id>https://patcave.me/tf2maps-infrastructure-overhaul-project/</id>
            <category term="Programming Stuff"/>
            <category term="Gaming"/>

        <updated>2022-04-26T05:02:16-06:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://patcave.me/media/posts/12/blueprints.png" alt="" />
                    I have been Technical Staff at TF2Maps.net for about a year as of writing this. One of the big things that bothered me when I first got onboard was how disorganized and chaotic the state of the infrastructure was. There wasn't a lot of it&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <img src="https://patcave.me/media/posts/12/blueprints.png" alt="" />
                <p>I have been Technical Staff at <a href="https://tf2maps.net">TF2Maps.net</a> for about a year as of writing this. One of the big things that bothered me when I first got onboard was how disorganized and chaotic the state of the infrastructure was. There wasn't a lot of it but it was old and fragile, and soon to be some serious hardware issues that needed to be addressed.</p>
<hr>
<h2>Unexpected hardware failures</h2>
<p> </p>
<figure class="post__image post__image--right"><img loading="lazy"  style="font-size: 18.4px; outline: 3px solid rgba(var(--primary-color-rgb), 0.55)  !important;" src="https://patcave.me/media/posts/12/download-1.jpg" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/12/responsive/download-1-xs.jpg 300w ,https://patcave.me/media/posts/12/responsive/download-1-sm.jpg 480w ,https://patcave.me/media/posts/12/responsive/download-1-md.jpg 768w ,https://patcave.me/media/posts/12/responsive/download-1-lg.jpg 1024w ,https://patcave.me/media/posts/12/responsive/download-1-xl.jpg 1360w ,https://patcave.me/media/posts/12/responsive/download-1-2xl.jpg 1600w"  alt="" width="266" height="116"></figure>
<p>In November of 2021, we discovered that our <span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">hardware was beginning to fail. We had been running a physical host out of a New York </span><a href="https://en.wikipedia.org/wiki/Colocation_centre" style="font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">colo</a><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);"> for nearly 8 years.</span></p>
<p>Usually disks and power supplies have a life of ~2-4 years, so its impressive we made it was far as we did, though scary because I was afraid our hardware could fail at basically any time.</p>
<p>In trying to allocate more disk to one of our VM's, our hypervisor <a href="https://www.proxmox.com/en/">Proxmox</a> told us that it detected bad sectors. Super oh no. These disks we're <a href="https://en.wikipedia.org/wiki/Standard_RAID_levels" target="_blank" rel="noopener noreferrer">RAID 0</a>, meaning we had no actual redundancy.</p>
<p>Additionally, our colo contract expired in February of 2022, meaning we would need to move all of our systems over to something new with the quickness.</p>
<hr>
<h2>Lay of the land</h2>
<p>The very first thing I did was assess the problem at hand and determine the scope of what we will do about it.</p>
<h4>So the obvious question is, what needs to move?</h4>
<p>I went onto every VM we had and took a thorough look to get an accounting of everything we would need to move or replace.</p>
<p>There was a lot more than I expected:</p>
<ul>
<li>Bind9 DNS</li>
<li>Dovecot Email server</li>
<li>Apache with 22 distinct virtual hosts
<ul>
<li>Many of which were just static html sites</li>
<li>One was the forum software</li>
<li>One was our custom built map queue site</li>
</ul>
</li>
<li>The Discord Bot</li>
<li>MySQL database</li>
<li>Almost 1TB of static attachment data on disk</li>
</ul>
<h4>Bills Bills Bills</h4>
<p>I also spoke with the incumbent system administrator about hosting cost; which I had found we were consistently spending more on hosting than we received in donations, and the difference came out of his pocket. Not great, and he defiantly was not happy with it.</p>
<p>After some research, I determined that we would likely need to upgrade our version of the <a href="https://xenforo.com/">Xenforo </a>fo<span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">rum software in order to manifest significant cost savings. So I tasked one of my "interns" with going into Xenforo and evaluate every existing plugin we ran on the old site, and asses it's criticality (must have, nice to have, dont need), as </span><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">well as if we have a migration path for that plugin to Xenforo 2. </span></p>
<p><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">This research was critical to learning if this was even possible, or if we would need to look into other solutions.</span></p>
<p><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">Side note: Google</span><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);"> Sprea</span><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">dsheets are</span><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);"> great for this kind of ongoing collaboration:</span></p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/12/gallery/Screenshot_774-3.png" data-size="920x666"><img loading="lazy" src="https://patcave.me/media/posts/12/gallery/Screenshot_774-3-thumbnail.png" alt="" width="720" height="521"></a></figure>
</div></div>
<hr>
<h2>Project Objectives</h2>
<ul>
<li>Have fully operational systems moved to new hardware before our colo contract expired</li>
<li>Reduce our hosting bill by at least 25%, but ideally as much as possible</li>
<li>Lower the maintenance overhead for all systems going forward</li>
<li>Bring us up to latest security best practices</li>
</ul>
<h3>Where to host it all?</h3>
<p>So the first order of business was to see what our hosting options could be. At a glance I figured we could leverage a cloud provider to replace a good amount of functionality for us, as well as possibly use S3 to host a lot of stuff for very cheap.</p>
<p>I put together a cost estimate for...</p>
<ul>
<li><a href="https://aws.amazon.com/">AWS</a></li>
<li><a href="https://www.digitalocean.com/">Digital Ocean</a></li>
<li><a href="https://www.vultr.com/">Vultr</a></li>
<li><a href="https://us.ovhcloud.com/">OVH</a></li>
</ul>
<figure class="post__image post__image--left"><img loading="lazy"  style="font-size: 18.4px; outline: 3px solid rgba(var(--primary-color-rgb), 0.55)  !important;" src="https://patcave.me/media/posts/12/grmuy1fs409mjcg3xrqs-md.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/12/responsive/grmuy1fs409mjcg3xrqs-md-xs.png 300w ,https://patcave.me/media/posts/12/responsive/grmuy1fs409mjcg3xrqs-md-sm.png 480w ,https://patcave.me/media/posts/12/responsive/grmuy1fs409mjcg3xrqs-md-md.png 768w ,https://patcave.me/media/posts/12/responsive/grmuy1fs409mjcg3xrqs-md-lg.png 1024w ,https://patcave.me/media/posts/12/responsive/grmuy1fs409mjcg3xrqs-md-xl.png 1360w ,https://patcave.me/media/posts/12/responsive/grmuy1fs409mjcg3xrqs-md-2xl.png 1600w"  alt="" width="237" height="181"></figure>
<p>AWS was cost prohibitive, though would have been the most feature rich one. OVH would mostly put us in a simliar situation as before.</p>
<p>So it was between DigitalOcean and Vultr. We ended up choosing Vultr because it had some slightly cheaper VM options and it has <em>way</em> more locations; which will be nice for ad-hoc game servers.</p>
<h3>Bill reduction strategy</h3>
<p>We had a lot of inefficiency in our hosting that we could fix. </p>
<p>First was all the static HTML sites we were serving. Vultr has an S3-type offering, so I assigned my "intern" the task of moving all of those sites into there. This will save us overhead on disk and also on just having less things to manage overall, since its setup and forget.</p>
<p>This was also a test for me to see how well their S3 setup works. The biggest hurdle was going to be figuring out if we can store our terabyte of attachment data out of S3 as well. A disk of that size for Vultr was going to be very expensive. </p>
<p>In researching this, I learned I could only do this if we upgraded our Xenforo software to 2+ (we were still running 1.4). Unfortunately there were no docs specifically for Vultr, but I was able to figure out how to get it to work, mostly by reading the source code of a few plugins. Xenforo 2 also allowed us to do a lot of things we had wanted to do for many years but were unable to because of XF 1 limitations.</p>
<p>Coupled with the cheap VM's that are offered by Vultr, and the use of S3 as a backend, as well as ad-hoc game servers; I believed we could significantly reduce our hosting cost this way.</p>
<hr>
<h2>The Prototypes</h2>
<p> </p>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/12/prototype-comic-2-en.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/12/responsive/prototype-comic-2-en-xs.png 300w ,https://patcave.me/media/posts/12/responsive/prototype-comic-2-en-sm.png 480w ,https://patcave.me/media/posts/12/responsive/prototype-comic-2-en-md.png 768w ,https://patcave.me/media/posts/12/responsive/prototype-comic-2-en-lg.png 1024w ,https://patcave.me/media/posts/12/responsive/prototype-comic-2-en-xl.png 1360w ,https://patcave.me/media/posts/12/responsive/prototype-comic-2-en-2xl.png 1600w"  alt="" width="299" height="261"></figure>There was a lot of unknowns going into this. This site has existed since 2007, there was literally 13 years of data we <em>absolutely could not lose</em>. If that data was lost it would be gone forever. To be confident in what I was going to do; i stood up several prototype instances.</p>
<p>One was a clean install of Xenforo 2 on a fresh Vultr VM so we could see what we wanted to end state to be.</p>
<p>This prototype had no data in the database or attachments. It was done this way to make it faster to setup and reduce any conversion issues, and it was way cheaper. I wanted a clean reference setup. Using the research we did before; we installed all the plugins we believed would cover our needs, and then did a lot of testing to be certain.</p>
<p>We spent probably a month or so working on setting up the clean install and getting familiar with Xenforo 2. I also assigned my "intern" the task of setting up a UI theme to be reminiscent of our branding and old website, built off a more modern base. We quickly realized how many hacks the old site had in its CSS and theme so that was a fun adventure in CSS and HTML, something I haven't done much of in a long time.</p>
<p>The next prototype site I stood up was a clone of the existing site without attachments. It's purpose was to test the migration path from version 1.x to 2.x. Basically, what are we going to run into when we do this for real? The process was actually pretty smooth, though there were a bunch of non-critical things that didn't make it over cleanly, and we had to come back later and fix those up. </p>
<hr>
<h2>The Great Migration</h2>
<p> </p>
<figure class="post__image post__image--right"><img loading="lazy"  src="https://patcave.me/media/posts/12/download.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/12/responsive/download-xs.png 300w ,https://patcave.me/media/posts/12/responsive/download-sm.png 480w ,https://patcave.me/media/posts/12/responsive/download-md.png 768w ,https://patcave.me/media/posts/12/responsive/download-lg.png 1024w ,https://patcave.me/media/posts/12/responsive/download-xl.png 1360w ,https://patcave.me/media/posts/12/responsive/download-2xl.png 1600w"  alt="" width="263" height="167"></figure>For most of January, I was rather busy given that my startup had just been <a href="https://narrativescience.com/resource/blog/narrative-science-signs-agreement-to-be-acquired-by-salesforce">acquired by Salesforce</a>, so my head was not really in a good space to work on this for TF2Maps. At this point though; all the research was done to be confident in our move, so we just needed to execute on it.</p>
<p>We had started moving some items in January in preparation of the VM move:</p>
<ul>
<li>DNS served out of Vultr</li>
<li>Email from a free email provider</li>
<li>Static HTML sites</li>
<li>Discord Bot</li>
<li><a href="https://patcave.me/game-server-monitoring/">Grafana</a></li>
</ul>
<p>There was absolutely no way to do this without taking the site offline while data moved. Thankfully, nothing bad happens if TF2Maps is down for a few days. I wish it worked this way with production systems at work...</p>
<p>The VM move was a tense 3 days. If something in this process failed we may have lost a lot of data, so we needed to be very precise and methodical. Here was the precise steps, in which I was in constant communication with my intern and other "stakeholders":</p>
<ol>
<li>Create new (final) VM for the Xenforo site inside Vultr</li>
<li>Put up a maintenance page to categorically prevent any DB writes from occurring</li>
<li>Move the SQL databases onto the new VM, and save a backup in S3</li>
<li>Attach a 1TB disk to the VM, and start the static file sync
<ul>
<li>This ended up taking 3 days to complete</li>
</ul>
</li>
<li>Clone the Xenforo 1 site</li>
<li>Perform the Xenforo upgrade</li>
<li>Setup all the new plugins and theme</li>
<li>Other Staff thoroughly inspect the site to knock out obvious issues first</li>
<li>Create a thread on the forums for end users to report bugs</li>
<li>Open it up to the public (Scary!)</li>
</ol>
<hr>
<h2>The Post Migration Chaos</h2>
<p>As usual with projects like this, we got dozens of bug reports and small issues.</p>
<p>To add to this, our first salvo was just to get us out of the colo expiration problem. We had not actually moved our attachments into S3, or created ad-hoc servers.</p>
<p>We would not be able to realize our cost savings until we had finally moved attachment data into S3. Again, this was easy because I already knew what to do because of the prototype phase we did. I had to once again take the site offline for a few days to do this. Once moved, I detached the disk, but kept it around as a hot backup incase something really went wrong with S3. After a week, I shutdown that disk, given it was quite expensive.</p>
<p>I assigned as many bugs to my intern as I felt he could reasonably handle while I tackled the more difficult ones. Together, we ended up fixing probably 50 issues over the course of a few weeks. These bugs were all over the place, and a lot of it was things we didn't purposely set or create. Needing to troubleshoot systems you're unfamiliar is uhhh, fun. </p>
<hr>
<h2>A major upgrade to security</h2>
<p>Now I don't want to knock on the people who set things up before I came along because they did a good job of just keeping the ship floating, but lets just say the state of security was a bit, uhhh, <em>nuanced</em>. </p>
<p>Thankfully, I've done server hardening many many times before. Over the next few weeks I worked on setting up:</p>
<ul>
<li>Least privilege database users</li>
<li>SSH key authentication only</li>
<li>No root user logins</li>
<li>SSH whitelisted to only administrators IP's</li>
<li>Stateful firewall (fail2ban)</li>
<li>Ulimits</li>
<li>Apache virtual hosts run in discrete sandboxes</li>
<li>Log rotate configs</li>
<li>Auto-renewing wildcard SSL cert from LetsEncrypt</li>
<li>Least privilege firewalls inside of Vultr</li>
<li>Forced HTTPS redirection</li>
</ul>
<hr>
<h2>Outcomes</h2>
<ul>
<li>Data move completed with 3 days to spare!</li>
<li><em>We did not lose any data whatsoever</em></li>
<li>The steady state hosting cost was reduced by over 65%!</li>
<li>Security is a lot better now</li>
<li>Automation now exists for all the mundane things
<ul>
<li>Automatic DB backups to S3 on a weekly cadance</li>
<li>Automatic SSL renewal</li>
<li>Xenforo -&gt; Discord rank syncing</li>
</ul>
</li>
<li>The site is much better protected from disasters given most of the data is in S3 and the rest is regularly backed up</li>
<li>Multiple people on Staff can now help me operate the site thanks to Xenforo 2 being a lot easier to administer.</li>
</ul>
<figure class="post__image post__image--center"><img loading="lazy"  src="https://patcave.me/media/posts/12/great-success.jpg" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/12/responsive/great-success-xs.jpg 300w ,https://patcave.me/media/posts/12/responsive/great-success-sm.jpg 480w ,https://patcave.me/media/posts/12/responsive/great-success-md.jpg 768w ,https://patcave.me/media/posts/12/responsive/great-success-lg.jpg 1024w ,https://patcave.me/media/posts/12/responsive/great-success-xl.jpg 1360w ,https://patcave.me/media/posts/12/responsive/great-success-2xl.jpg 1600w"  alt="" width="576" height="432"></figure>
<hr>
<h2>Learnings</h2>
<p>To be successful here, I had to wear a lot of different hats. I was basically the lead developer, project manager, ui designer, QA, security, and finance. I had a few people who were technical enough I could slice off some simple tasks and assign them to those people which did help a lot. Shout out to my intern!</p>
<p>The most difficult thing to do was cut through all the people wanting to shoot from the hip and get something out quick and also managing peoples expectations. Most of the people involved have not been a part of a project such as this before so I had to also wear the hat of the mentor. I had to guide everyone through a process which I had developed from doing migration projects like this at work. I have a systematic process to do this, but it was defiantly challenging getting folks onboard and to trust that I knew what I was doing. There was a great deal of skepticism that I would be able to actually pull this off, and to a degree, I myself was unsure if I would actually be able to deliver on some of the goals, mostly relating to cost optimization. The research step helped ease a lot of peoples concerns because I had proof that we would be able to actually pull this off.</p>
<p>The other thing to do was managing the expectations of our user base. We probably have about 1000 active users, so we got absolutely slammed with requests for a few weeks. My intern helped triage a lot of this stuff which was a nice burden off my shoulders, since I could focus on much bigger picture things. Of course every person feels the issue they are reporting is the most important one and you have to be patient and communicate that we acknowledge the issue and we are going to get to it when we can given its difficulty to fix and its value to the community as a whole while also reminding them that I am doing this without being paid at all. Some issues however, we probably just aren't going to fix because they're so difficult and low value. You have to accept that in projects like this, those things are going to happen.</p>
<p>Another thing I did here was to coach the rest of staff to act on my behalf and get in front of issues and snowballing discussions about the new site. I defiantly succeeded here in rallying dozens of people to assist me when I needed it. I think the key to this is being transparent and very clear about what you need from them and also modeling the behavior you want.</p>
<hr>
<h2>The Process in Bullet form</h2>
<ol>
<li>Assess the scope of the problem at hand, i.e. what do we need to solve for?</li>
<li>Research solutions
<ul>
<li>Create prototypes to learn about a solution so you can pivot your research if needed</li>
<li>Setup cost estimates</li>
<li>Estimate the scope of work involved, and determine the must-haves
<ul>
<li>Try to organize the work such that you can farm out to multiple people</li>
</ul>
</li>
</ul>
</li>
<li>Prioritize work based on the constraints of the problem (such as our colo contract expiration)</li>
<li>Action the minimum critical scope as your first salvo</li>
<li>Openly seek feedback</li>
<li>Iterate on improvements and bug fixes until completion</li>
</ol>
<p>Don't forget to openly communicate to stakeholders about where you are in this process and be open about your unknowns. Seek to resolve those unknowns in your research as much as possible.</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>My choice tools for Cloud Engineering</title>
        <author>
            <name>Patrick Hennessy</name>
        </author>
        <link href="https://patcave.me/my-choice-tools-for-cloud-engineering/"/>
        <id>https://patcave.me/my-choice-tools-for-cloud-engineering/</id>
            <category term="Programming Stuff"/>

        <updated>2022-04-21T03:55:42-06:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://patcave.me/media/posts/10/cover-2.png" alt="" />
                    I'm an engineer, which means I love my tools and there's some tools I hate. I guess that comes with the territory. This is the collection of tools I try to use anytime I can for Cloud Engineering tasks. Ill format this by category, and&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <img src="https://patcave.me/media/posts/10/cover-2.png" alt="" />
                <p><a href="https://www.youtube.com/watch?v=SNgNBsCI4EA" target="_blank" rel="noopener noreferrer">I'm an engineer</a>, which means I love my tools and there's some tools I hate. I guess that comes with the territory. This is the collection of tools I try to use anytime I can for Cloud Engineering tasks.</p>
<p>Ill format this by category, and list out my likes and dislikes about the tool. Realize that each one of these is just my <em>opinion</em> and I'm not saying they're the only tool anyone should ever use, people have different preferences and needs afterall. Enjoy!</p>
<hr>
<h2>Infrastructure as Code: <em><a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">Terraform</a></em></h2>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/10/terraform-logo.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/10/responsive/terraform-logo-xs.png 300w ,https://patcave.me/media/posts/10/responsive/terraform-logo-sm.png 480w ,https://patcave.me/media/posts/10/responsive/terraform-logo-md.png 768w ,https://patcave.me/media/posts/10/responsive/terraform-logo-lg.png 1024w ,https://patcave.me/media/posts/10/responsive/terraform-logo-xl.png 1360w ,https://patcave.me/media/posts/10/responsive/terraform-logo-2xl.png 1600w"  alt="" width="192" height="192"></figure>
<p>Terraform is a tool that allows you to define your cloud infrastructure as code. It is intended to be declarative rather than programmatic, but it does a good job of balancing between the two. </p>
<p> </p>
<p> </p>
<table style="border-collapse: collapse; width: 100%; border-style: hidden;" border="0">
<tbody>
<tr>
<td style="width: 50%;"><strong>Things I like</strong></td>
<td style="width: 50%;"><strong>Things I don't like</strong></td>
</tr>
<tr>
<td style="width: 50%;">
<ul>
<li>Deployment is part of the tool automatically. No need to write custom deploy or wrapper code</li>
<li>Support for variables, loops, conditionals and reusability</li>
<li><a href="https://registry.terraform.io/browse/modules" target="_blank" rel="noopener noreferrer">Module repository</a></li>
<li>Backend agnostic. Well suited for multi-cloud situations</li>
<li>Backed by Hashicorp but completely FOSS</li>
<li>Very popular which means lots of good Stack Overflow posts on gotchas</li>
<li><a href="https://www.terraform.io/cloud-docs/cost-estimation" target="_blank" rel="noopener noreferrer">Cost Estimation</a></li>
</ul>
</td>
<td style="width: 50%;">
<ul>
<li>State management is literally a flat file that itself needs to be centrally managed</li>
<li>The looping syntax is quite confusing</li>
<li>Not always 100% up to date with it's AWS provider</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Admittedly I am a bit biased because the only other tool in this space I've used is CloudFormation, which works well for small use cases but quickly becomes unmanageable when you have a fast changing dynamic environment like the cloud.</p>
<p>In my mind, the 3 big players for IaC are: <em><a href="https://aws.amazon.com/cloudformation/" target="_blank" rel="noopener noreferrer">CloudFormation</a></em>, <em>Terraform </em>and <em><a href="https://www.pulumi.com/" target="_blank" rel="noopener noreferrer">Pulumi</a></em>. The way I like to think about it is a spectrum where CloudFormation being the most "declarative" while Pulumi is almost literally just a library in a programming language. Terraform leans towards being declarative but has much better support for things like conditionals, loops, variables, passing data between modules and other programming language paradigms.</p>
<figure class="post__image post__image--center"><img loading="lazy"  src="https://patcave.me/media/posts/10/spectrum.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/10/responsive/spectrum-xs.png 300w ,https://patcave.me/media/posts/10/responsive/spectrum-sm.png 480w ,https://patcave.me/media/posts/10/responsive/spectrum-md.png 768w ,https://patcave.me/media/posts/10/responsive/spectrum-lg.png 1024w ,https://patcave.me/media/posts/10/responsive/spectrum-xl.png 1360w ,https://patcave.me/media/posts/10/responsive/spectrum-2xl.png 1600w"  alt="" width="1576" height="496"></figure>
<p> </p>
<hr>
<h2>Configuration Management: <em><a href="https://www.ansible.com/" target="_blank" rel="noopener noreferrer">Ansible</a></em></h2>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/10/Ansible_logo.svg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/10/responsive/Ansible_logo.svg-xs.png 300w ,https://patcave.me/media/posts/10/responsive/Ansible_logo.svg-sm.png 480w ,https://patcave.me/media/posts/10/responsive/Ansible_logo.svg-md.png 768w ,https://patcave.me/media/posts/10/responsive/Ansible_logo.svg-lg.png 1024w ,https://patcave.me/media/posts/10/responsive/Ansible_logo.svg-xl.png 1360w ,https://patcave.me/media/posts/10/responsive/Ansible_logo.svg-2xl.png 1600w"  alt="" width="156" height="192"></figure>
<p>Ansible allows one to codify the steps to provisioning a virtual machine or a Docker image, allowing one to reproduce their configuration whenever needed.</p>
<p> </p>
<p> </p>
<table style="border-collapse: collapse; width: 100%; border-style: hidden;" border="0">
<tbody>
<tr>
<td style="width: 50%;"><strong>Things I like</strong></td>
<td style="width: 50%;"><strong>Things I don't like</strong></td>
</tr>
<tr>
<td style="width: 50%;">
<ul>
<li>No weird metaphors for it's features like "Salt Pillar" or "Cookbook"</li>
<li>Executes serially but can be made to <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_strategies.html" target="_blank" rel="noopener noreferrer">run in parallel</a></li>
<li>No agent to install and run</li>
<li>No additional infrastructure needed</li>
<li><a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html" target="_blank" rel="noopener noreferrer">Reusable roles</a> and <a href="https://galaxy.ansible.com/" target="_blank" rel="noopener noreferrer">pre-made roles</a></li>
<li>Allows for variables and looping</li>
<li><a href="https://docs.ansible.com/ansible/latest/dev_guide/developing_modules_general.html" target="_blank" rel="noopener noreferrer">Extendable with Python</a></li>
<li><a href="https://janikvonrotz.ch/2018/03/07/profiling-ansible-roles-and-tasks/" target="_blank" rel="noopener noreferrer">Task profiling</a></li>
<li>Maintained by RedHat</li>
<li>Great documentation</li>
</ul>
</td>
<td style="width: 50%;">
<ul>
<li>Doesn't "guarantee" what is written will be reality</li>
<li>With roles, sometimes it's hard to follow the flow of execution</li>
<li>Some built-in modules (e.g. Docker) require system packages to be installed before the task can run. This is also poorly documented in most cases.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Honestly I feel like I could keep going on and on with this list of pro's.</p>
<p>Personally I've used the task profiling to setup a playbook with parallelization which gave us a dramatic speed up in execution time. Using those 2 features we went from 3 hour runs down to ~25 minutes.</p>
<p>Competitors I've used are <a href="https://www.fabfile.org/" target="_blank" rel="noopener noreferrer">Fabric</a> (Python lib) and <a href="https://saltproject.io/" target="_blank" rel="noopener noreferrer">SaltStack</a>. I've dabbled a bit with <a href="https://www.chef.io/" target="_blank" rel="noopener noreferrer">Chef</a> but am very unfamiliar with it. Fabric is no longer maintained because of the Python 3 switch, but I do like the concept of managing state with the power of a programming language, but also fear that it can become very unruly very quick if you maintain poor abstractions. I like Ansible because it puts guard rails on those abstractions so things really can't get too complex or hard to understand.</p>
<p>For what Ansible is, it does a great job and is one of the more reliable tools I regularly use at work.</p>
<hr>
<h2>Version Control: <em><a href="https://github.com/" target="_blank" rel="noopener noreferrer">Github</a> / <a href="https://git-scm.com/" target="_blank" rel="noopener noreferrer">Git</a></em></h2>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/10/25231.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/10/responsive/25231-xs.png 300w ,https://patcave.me/media/posts/10/responsive/25231-sm.png 480w ,https://patcave.me/media/posts/10/responsive/25231-md.png 768w ,https://patcave.me/media/posts/10/responsive/25231-lg.png 1024w ,https://patcave.me/media/posts/10/responsive/25231-xl.png 1360w ,https://patcave.me/media/posts/10/responsive/25231-2xl.png 1600w"  alt="" width="192" height="192"></figure>
<p>Github is a remote code repository and developer platform. It is obviously backed by the company Github itself. It is by far the most popular code repository of it's kind, built by coder for coders.</p>
<p> </p>
<p> </p>
<table style="border-collapse: collapse; width: 100%; border-style: hidden;" border="0">
<tbody>
<tr>
<td style="width: 50%;"><strong>Things I like</strong></td>
<td style="width: 50%;"><strong>Things I don't like</strong></td>
</tr>
<tr>
<td style="width: 50%;">
<ul>
<li>UI makes the complexity of Git feel much less so</li>
<li>Pull request comment and approval workflow is really nice</li>
<li>Merging a PR can be gated by tests passing or needing approvals</li>
<li>Code Owners</li>
<li>Github pages is nice for making static docs for your project</li>
<li>Github Actions!</li>
<li>Private repo's are now free!</li>
</ul>
</td>
<td style="width: 50%;">
<ul>
<li>Git itself is very confusing if you stray away from the branch, add, commit, push workflow</li>
<li>Git has a bit of a steep learning curve and lot of jargon</li>
<li>New Git users often get into crazy Git states and have to be destructive to get out of it</li>
<li>Github's permissions are not granular enough for a medium to large organization</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>I have only really used <a href="https://tortoisesvn.net/" target="_blank" rel="noopener noreferrer">TortiseSVN</a> as an alternative, and it's workflow always felt clunky to me. I was using it right when I started learning programming so perhaps it's not as bad as I remember.</p>
<p>Git is so popular and ingrained in my head that I honestly don't know how I would switch away unless I joined a company that ran another one.</p>
<p>I should also mention that <a href="gitlab.com" target="_blank" rel="noopener noreferrer">Gitlab</a> is also pretty nice in comparison to Github, though I still prefer Github probably just out of familiarity alone. Both do seem to offer the same things.</p>
<hr>
<h2>Programming Language: <em><a href="https://www.python.org/" target="_blank" rel="noopener noreferrer">Python</a></em></h2>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/10/1200px-Python-logo-notext.svg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/10/responsive/1200px-Python-logo-notext.svg-xs.png 300w ,https://patcave.me/media/posts/10/responsive/1200px-Python-logo-notext.svg-sm.png 480w ,https://patcave.me/media/posts/10/responsive/1200px-Python-logo-notext.svg-md.png 768w ,https://patcave.me/media/posts/10/responsive/1200px-Python-logo-notext.svg-lg.png 1024w ,https://patcave.me/media/posts/10/responsive/1200px-Python-logo-notext.svg-xl.png 1360w ,https://patcave.me/media/posts/10/responsive/1200px-Python-logo-notext.svg-2xl.png 1600w"  alt="" width="192" height="192"></figure>
<p>Okay before you bite my head off saying its "too slow", remember this post is about the role of a<em> Cloud Engineer</em>, not a HPC or ML engineer. Python has dozens of useful libraries and has a long history of being used as a systems language.</p>
<p> </p>
<p> </p>
<table style="border-collapse: collapse; width: 100%; border-style: hidden;" border="0">
<tbody>
<tr>
<td style="width: 50%;"><strong>Things I like</strong></td>
<td style="width: 50%;"><strong>Things I don't like</strong></td>
</tr>
<tr>
<td style="width: 50%;">
<ul>
<li><a href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" target="_blank" rel="noopener noreferrer">Boto3</a> library is great for writing glue code for AWS or as part of a Lambda</li>
<li>All Linux distros ship with Python by default</li>
<li>Most OS tools use Python and can be extended using it (e.g. Systemd)</li>
<li>Very helpful traceback's</li>
<li><a href="https://docs.python.org/3/library/pdb.html" target="_blank" rel="noopener noreferrer">PDB</a> - Very easy to debug</li>
<li><a href="https://insights.stackoverflow.com/survey/2021#most-popular-technologies-language" target="_blank" rel="noopener noreferrer">3rd most popular language</a></li>
<li>Syntax often reads like pseudo-code (most "sys admins" can barely code, this is a big plus)</li>
<li>Language features work well together. Decorators, comprehensions, iterators, dataclasses, dicts, just to name a few.</li>
</ul>
</td>
<td style="width: 50%;">
<ul>
<li>It's package management ecosystem was designed by Satan himself</li>
<li>Subprocessing and multiprocessing are not as easy as something like Bash.</li>
<li>Python 2 vs 3 switch. I still find old Python 2 scripts laying around</li>
<li>Arguments about the 80 char lines</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The obvious elephant in the room is Bash. I have a love - hate relationship with Bash, but also feel very inadequate because I've been using daily it for over 10 years and still have to Google basic syntax every time I use it.</p>
<p>The way I think about these 2 "languages" (if you can even call bash a language) is that Bash is great for simple things that you run on your command line, but the second you need more than 1 if statement, you should seriously consider using Python instead. Also bash sucks at handling JSON output and Python defiantly shines there.</p>
<p>I know that Hashicorp was trying to make Ruby the Cloud Engineer language of choice but just doesn't seem to have taken off the same way as Python has.</p>
<p>Just for fun, here's some of my favorite Python libraries:</p>
<ul>
<li><a href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" target="_blank" rel="noopener noreferrer">boto3</a></li>
<li><a href="https://fastapi.tiangolo.com/" target="_blank" rel="noopener noreferrer">FastAPI</a></li>
<li><a href="https://pydantic-docs.helpmanual.io/" target="_blank" rel="noopener noreferrer">Pydantic</a></li>
<li><a href="https://jinja.palletsprojects.com/" target="_blank" rel="noopener noreferrer">Jinja2</a></li>
<li><a href="https://collerek.github.io/ormar/" target="_blank" rel="noopener noreferrer">ormar</a> or <a href="https://roman-right.github.io/beanie/">beanie</a><a href="#INTERNAL_LINK#/post/null" target="_blank" rel="noopener noreferrer"></a></li>
<li><a href="https://www.paramiko.org/" target="_blank" rel="noopener noreferrer">paramiko</a></li>
<li><a href="https://docs.python-requests.org/" target="_blank" rel="noopener noreferrer">requests</a> or <a href="https://www.python-httpx.org/" target="_blank" rel="noopener noreferrer">httpx</a> (async)</li>
<li><a href="https://rich.readthedocs.io/en/stable/introduction.html" target="_blank" rel="noopener noreferrer">rich</a></li>
<li><a href="https://python-prompt-toolkit.readthedocs.io/en/master/" target="_blank" rel="noopener noreferrer">PromptToolkit</a></li>
<li><a href="https://github.com/Delgan/loguru" target="_blank" rel="noopener noreferrer">loguru</a></li>
</ul>
<hr>
<h2>Monitoring: <em><a href="https://prometheus.io/" target="_blank" rel="noopener noreferrer">Prometheus</a> + <a href="https://grafana.com/" target="_blank" rel="noopener noreferrer">Grafana</a></em></h2>
<figure class="post__image post__image--center"><img loading="lazy"  src="https://patcave.me/media/posts/10/grafaf.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/10/responsive/grafaf-xs.png 300w ,https://patcave.me/media/posts/10/responsive/grafaf-sm.png 480w ,https://patcave.me/media/posts/10/responsive/grafaf-md.png 768w ,https://patcave.me/media/posts/10/responsive/grafaf-lg.png 1024w ,https://patcave.me/media/posts/10/responsive/grafaf-xl.png 1360w ,https://patcave.me/media/posts/10/responsive/grafaf-2xl.png 1600w"  alt="" width="420" height="192"></figure>
<p>I've already written about this subject when discussing <a href="https://patcave.me/game-server-monitoring/" target="_blank" rel="noopener noreferrer">monitoring for my Team Fortress servers</a> but ill summarize here.</p>
<p> </p>
<table style="border-collapse: collapse; width: 100%; border-style: hidden;" border="0">
<tbody>
<tr>
<td style="width: 50%;"><strong>Things I like</strong></td>
<td style="width: 50%;"><strong>Things I don't like</strong></td>
</tr>
<tr>
<td style="width: 50%;">
<ul>
<li>Very easy to get going out of the box</li>
<li>PromQL and Grafana explorer are very easy to use</li>
<li>Grafana dashboards are very easy and intuitive to create</li>
<li>Grafana supports tables and text nodes</li>
</ul>
</td>
<td style="width: 50%;">
<ul>
<li>Alerting with AlertManager is not the greatest</li>
</ul>
</td>
</tr>
</tbody>
</table>
<hr>
<h2>Code Editor: <em><a href="https://code.visualstudio.com/" target="_blank" rel="noopener noreferrer">VS Code</a></em></h2>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/10/Visual_Studio_Code_1.35_icon.svg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/10/responsive/Visual_Studio_Code_1.35_icon.svg-xs.png 300w ,https://patcave.me/media/posts/10/responsive/Visual_Studio_Code_1.35_icon.svg-sm.png 480w ,https://patcave.me/media/posts/10/responsive/Visual_Studio_Code_1.35_icon.svg-md.png 768w ,https://patcave.me/media/posts/10/responsive/Visual_Studio_Code_1.35_icon.svg-lg.png 1024w ,https://patcave.me/media/posts/10/responsive/Visual_Studio_Code_1.35_icon.svg-xl.png 1360w ,https://patcave.me/media/posts/10/responsive/Visual_Studio_Code_1.35_icon.svg-2xl.png 1600w"  alt="" width="192" height="192"></figure>
<p>VS Code is a code editor created and maintained by Microsoft. It's relatively lightweight and can become very fully featured via their extensions.</p>
<p> </p>
<p> </p>
<p> </p>
<p>Normally I don't like throwing my hat in the ring for things as subjective as a code editor. <em>Everyone</em> has strong opinions about this, however VS Code has a few things I believe seperate it from other editors in it's class.</p>
<p> </p>
<table style="border-collapse: collapse; width: 100%; border-style: hidden;" border="0">
<tbody>
<tr>
<td style="width: 50%;"><strong>Things I like</strong></td>
<td style="width: 50%;"><strong>Things I don't like</strong></td>
</tr>
<tr>
<td style="width: 50%;">
<ul>
<li>Very modular and robust extension ecosystem</li>
<li><a href="https://code.visualstudio.com/docs/remote/remote-overview" target="_blank" rel="noopener noreferrer">Remote Developer Pack</a></li>
<li>Built-in Git features</li>
<li>Fast code searching</li>
<li>Built-in terminal tab's</li>
<li><code>Ctrl + P</code> fast search menu</li>
<li>Saves your entire setup to a config file that can be shared on new machines</li>
<li>Offers suggestions for extensions if you open a file that is an unrecognized format</li>
<li>Command line integration via the <code>code</code> cli (A bit of a pretentious name for their cli)</li>
</ul>
</td>
<td style="width: 50%;">
<ul>
<li>Intellisense is very dumb unless you do a lot of configuration</li>
<li>Terminal can only be split vertically, sometimes I want to split horizontally</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>I've used so many text editors over the years: Brackets, Atom, Notepad++, Sublime, Bluefish, GGTS, Eclipse, Visual Studio, and even just VIM. To be honest, until I started using VS Code, mostly I chose an editor based on if I could find a syntax color theme I liked. </p>
<p>I will say the #1 thing I love about VS Code is the <a href="https://code.visualstudio.com/docs/remote/remote-overview" target="_blank" rel="noopener noreferrer">Remote Developer Pack</a>. Instead of running an SFTP plugin or having just a terminal in another screen, this is a truely seamless experience. You get all the same code searching and features normally only available locally with it. I've been using it to connect to remote servers as well as with <a href="https://docs.microsoft.com/en-us/windows/wsl/install" target="_blank" rel="noopener noreferrer">Windows WSL</a>. </p>
<p>VS Code is not as oriented to a specific task as an IDE like Eclipse or Visual Studio. This is actually nice for me since I work on a lot of different tasks and like that I can tailor VS code to my needs, instead of trying to shoe horn stuff into other IDE's.</p>
<hr>
<h2>Cloud Provider: <em>Too difficult to say</em></h2>
<p>Haha didn't expect that one did you?</p>
<p>I feel like this is very dependent on the task. Obviously I like any provider that has integration with other tools I mentioned. So ill just talk briefly about the one's I've used.</p>
<h3><a href="https://aws.amazon.com/" target="_blank" rel="noopener noreferrer">AWS</a></h3>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/10/eeYUFCO.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/10/responsive/eeYUFCO-xs.png 300w ,https://patcave.me/media/posts/10/responsive/eeYUFCO-sm.png 480w ,https://patcave.me/media/posts/10/responsive/eeYUFCO-md.png 768w ,https://patcave.me/media/posts/10/responsive/eeYUFCO-lg.png 1024w ,https://patcave.me/media/posts/10/responsive/eeYUFCO-xl.png 1360w ,https://patcave.me/media/posts/10/responsive/eeYUFCO-2xl.png 1600w"  alt="" width="128" height="128"></figure>The biggest player in this space and by far the most features and services, most of which I don't generally use. AWS's core things work very well, but one thing I don't like about AWS is how a lot of the newer tools feel kind of thrown together and often have a lot of problems actually using them. As with their UI, the experience of the developer feels like an afterthought a lot of the time. </p>
<p>AWS is the only one I've used that has a robust virtual networking offering which is huge for any company trying to do basic network security. And on the subject of security; IAM permissions are a horrendous pain to use, especially if you're not familiar with all the in's and outs of how it works; though no other provider does it any better.</p>
<p>AWS is also by far the most expensive one here. For hobby projects, it's a bit costly unless you really do a good job with cost management. AWS also makes it easy to spend way more than you expect and you need dedicated engineers to pay attention to this kind of thing.</p>
<p>For business uses, I think AWS is the clear choice.</p>
<h3><a href="https://cloud.google.com/" target="_blank" rel="noopener noreferrer">Google Cloud</a></h3>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/10/Google-Cloud-Platform-GCP-logo.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/10/responsive/Google-Cloud-Platform-GCP-logo-xs.png 300w ,https://patcave.me/media/posts/10/responsive/Google-Cloud-Platform-GCP-logo-sm.png 480w ,https://patcave.me/media/posts/10/responsive/Google-Cloud-Platform-GCP-logo-md.png 768w ,https://patcave.me/media/posts/10/responsive/Google-Cloud-Platform-GCP-logo-lg.png 1024w ,https://patcave.me/media/posts/10/responsive/Google-Cloud-Platform-GCP-logo-xl.png 1360w ,https://patcave.me/media/posts/10/responsive/Google-Cloud-Platform-GCP-logo-2xl.png 1600w"  alt="" width="128" height="128"></figure>I think the biggest thing GCP has going for it is that it's UI feels "designed" and like it's not programmatically generated. </p>
<p>I had used GCP for a while with my <a href="https://patcave.me/automate-all-the-things/" target="_blank" rel="noopener noreferrer">Team Fortress 2 servers</a>, but ultimately ended up moving to AWS because of the lack of features for VM management and their API wasn't quite as simple to integrate with as AWS (GCP has no equivalent to <a href="https://aws.amazon.com/sdk-for-python/" target="_blank" rel="noopener noreferrer">boto3</a>)</p>
<p>GCP's user permissions are also way more byzantine than I expected, and is somehow more confusing to me than AWS IAM. I can't believe I'm going to say this sentence: I'd rather use AWS IAM over GCP's permissions.</p>
<p>They offer a similar suite of features to that of AWS, and is a serious contender for business use cases.</p>
<p>On the subject of cost, GCP has way better cost estimation tools and they tell you the price before you stand something up in their UI; something AWS just simply does not do. Though that said, most of the time I'm standing up infrastructure programmatically so I don't really see this kind of thing often.</p>
<h3><a href="https://www.vultr.com/" target="_blank" rel="noopener noreferrer">Vultr</a></h3>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/10/grmuy1fs409mjcg3xrqs.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/10/responsive/grmuy1fs409mjcg3xrqs-xs.png 300w ,https://patcave.me/media/posts/10/responsive/grmuy1fs409mjcg3xrqs-sm.png 480w ,https://patcave.me/media/posts/10/responsive/grmuy1fs409mjcg3xrqs-md.png 768w ,https://patcave.me/media/posts/10/responsive/grmuy1fs409mjcg3xrqs-lg.png 1024w ,https://patcave.me/media/posts/10/responsive/grmuy1fs409mjcg3xrqs-xl.png 1360w ,https://patcave.me/media/posts/10/responsive/grmuy1fs409mjcg3xrqs-2xl.png 1600w"  alt="" width="128" height="97"></figure>I like Vultr. It's simple. They have a lot of good locations in the US, which is great for me as someone who hosts game servers. </p>
<p>They obviously don't have nearly as many features as AWS or GCP, but they knock their VM stuff out of the park. Infact you can literally upload your own .iso to it and just run that; opening up the possibility of doing local builds and just sharing an .iso. They also have Windows VM's if you need that kind of thing.</p>
<p>They have recently added an S3-compatible "spaces" offering which I'm using to good effect for TF2maps static sites. It's not fully flushed out though, so I'll hold my judgement on it for now.</p>
<p>It has everything you need for small projects. Built-in DNS, VM's, Block Storage, Firewalls, Load Balancers. It's networking is lacking a bit in my opinion. </p>
<p>3 features I want from Vultr:</p>
<ul>
<li>An AWS Fargate type docker runtime. Basically I just give you a container and you run it</li>
<li>Lambda's</li>
<li>Managed databases</li>
</ul>
<p>A few years ago I had a lot of networking issues hosting game servers, which has turned me off from using them. It appears that this is no longer a problem given we're running almost entirely on Vultr at TF2Maps.</p>
<h3><a href="https://www.digitalocean.com/" target="_blank" rel="noopener noreferrer">DigitalOcean</a></h3>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/10/1200px-DigitalOcean_logo.svg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/10/responsive/1200px-DigitalOcean_logo.svg-xs.png 300w ,https://patcave.me/media/posts/10/responsive/1200px-DigitalOcean_logo.svg-sm.png 480w ,https://patcave.me/media/posts/10/responsive/1200px-DigitalOcean_logo.svg-md.png 768w ,https://patcave.me/media/posts/10/responsive/1200px-DigitalOcean_logo.svg-lg.png 1024w ,https://patcave.me/media/posts/10/responsive/1200px-DigitalOcean_logo.svg-xl.png 1360w ,https://patcave.me/media/posts/10/responsive/1200px-DigitalOcean_logo.svg-2xl.png 1600w"  alt="" width="128" height="128"></figure>Very similar to Vultr, and similarly I do like DigitalOcean for the same reasons. Their networking is more mature and they do have a database offering as well. They recently launched an Apps feature, which as far as I can tell is basically just <a href="https://www.heroku.com/" target="_blank" rel="noopener noreferrer">Heroku</a>.</p>
<p> </p>
<p>If DigitalOcean added the features i mentioned in the Vultr section, I'd happily switch to them. They have the managed DB part down.</p>
<hr>
<h2>Honorable Mentions</h2>
<ul>
<li><a href="https://www.packer.io/" target="_blank" rel="noopener noreferrer">Packer </a>- A simple program for doing Golden image builds. Very modular and simple</li>
<li><a href="https://cloud.redhat.com/learn/topics/rkt" target="_blank" rel="noopener noreferrer">RKT</a> - A Docker-compatible runtime that has a lot more security features vs Docker itself. </li>
<li><a href="https://www.pgcli.com/" target="_blank" rel="noopener noreferrer">pgcli</a>, <a href="https://www.mycli.net/" target="_blank" rel="noopener noreferrer">mycli</a>, <a href="https://github.com/dbcli/litecli" target="_blank" rel="noopener noreferrer">litecli</a> - Database CLI's that use <a href="https://python-prompt-toolkit.readthedocs.io/en/master/" target="_blank" rel="noopener noreferrer">Prompt-Toolkit</a>. Nice features like syntax highlighting, and context aware tab completion</li>
<li><a href="https://github.com/tmux/tmux/wiki" target="_blank" rel="noopener noreferrer">tmux</a> - Great for running some services in the background without losing access to the command line. Also great for doing multiple tasks on a VM at the same time</li>
<li><a href="https://stedolan.github.io/jq/" target="_blank" rel="noopener noreferrer">jq</a> - An attempt to make JSON parsing work in bash without crazy awk, sed and grep pipelines.</li>
<li><a href="https://www.figma.com/" target="_blank" rel="noopener noreferrer">Figma </a>- A free UI prototyping tool. Mostly I've used this as a way to show a more tangible face to some of the backend things I want to do at TF2Maps.</li>
<li><a href="https://www.lucidchart.com/pages/">LucidCharts</a> - Great for making infrastructure diagrams</li>
<li><a href="https://github.com/duo-labs/cloudtracker" target="_blank" rel="noopener noreferrer">CloudTracker </a>- A great tool for creating least priveledge IAM permissions</li>
</ul>
<hr>
<h2>These are <em>just </em>tools</h2>
<p>It's important to remember that just like a hammer is a tool, all of these are just tools for specific tasks. I'm not married to any one of these tools and will switch if another tool comes along that solves my problem better. </p>
<p>To me it's more important to follow principals of staying organized than to become obsessed with how a certain tool solves a problem. Almost all of these tools I like because they allow me to maintain that kind of simplicity and organization that I want.</p>
<p>One final thought; remember that everyone's use case is different and sometimes a tool is still a better choice even when it has less exciting features because of things like cost and whether engineers at your organization are already familiar with it. There is a cost to onboarding new tools and learning their paradigms.</p>
<p> </p>
<p> </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>I&#x27;m officially a &quot;professional&quot; game designer!</title>
        <author>
            <name>Patrick Hennessy</name>
        </author>
        <link href="https://patcave.me/i-am-officially-a-professional-game-designer/"/>
        <id>https://patcave.me/i-am-officially-a-professional-game-designer/</id>
            <category term="Level Design"/>
            <category term="Gaming"/>

        <updated>2022-01-28T22:43:05-07:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://patcave.me/media/posts/5/Pd_farmageddon.png" alt="" />
                    Okay okay, maybe that title is a bit of an overstatement, but I have very exciting news! Among my many hobbies; one I've been doing since the beginning of the pandemic is level design, specifically for the game: Team Fortress 2. I'm excited to share&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <img src="https://patcave.me/media/posts/5/Pd_farmageddon.png" alt="" />
                <p>Okay okay, maybe that title is a bit of an overstatement, but I have very exciting news!</p>
<p>Among my many hobbies; one I've been doing since the beginning of the pandemic is level design, specifically for the game: Team Fortress 2.</p>
<p>I'm excited to share that today Valve purchased a level that I worked on (with a team of 8 others)!</p>
<p>Here is the Steam Workshop link: <a href="https://steamcommunity.com/sharedfiles/filedetails/?id=2237224308">https://steamcommunity.com/sharedfiles/filedetails/?id=2237224308</a></p>
<hr>
<h2>Farmageddon</h2>
<p>The concept of the map is that a farmer, in wanting to make the biggest pumpkin he could, gave his pumpkin radioactive sludge to make it as big as possible. It's possible that he was eaten by his creation...</p>
<p>Your job is to collect enough weed killer to kill this abomination!</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="3">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/5/gallery/download-3.jpg" data-size="1680x1050"><img loading="lazy" src="https://patcave.me/media/posts/5/gallery/download-3-thumbnail.jpg" alt="" width="720" height="450"></a>
<figcaption>Gourdon, the pumpkin monster</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/5/gallery/1280px-Farmageddon_RED_Grain_Shed_Outside.jpeg" data-size="1280x800"><img loading="lazy" src="https://patcave.me/media/posts/5/gallery/1280px-Farmageddon_RED_Grain_Shed_Outside-thumbnail.jpeg" alt="" width="720" height="450"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/5/gallery/download-1-2.jpg" data-size="1680x1050"><img loading="lazy" src="https://patcave.me/media/posts/5/gallery/download-1-2-thumbnail.jpg" alt="" width="720" height="450"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/5/gallery/download-1.jpg" data-size="637x358"><img loading="lazy" src="https://patcave.me/media/posts/5/gallery/download-1-thumbnail.jpg" alt="" width="637" height="358"></a>
<figcaption>Beware of the scarecrow monsters!</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/5/gallery/Farmageddon_Inside_Pumpkin.png" data-size="1920x1080"><img loading="lazy" src="https://patcave.me/media/posts/5/gallery/Farmageddon_Inside_Pumpkin-thumbnail.png" alt="" width="720" height="405"></a>
<figcaption>Inside the pumpkin, you can find his heart</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/5/gallery/Farmageddon_overview.png" data-size="1366x768"><img loading="lazy" src="https://patcave.me/media/posts/5/gallery/Farmageddon_overview-thumbnail.png" alt="" width="720" height="405"></a>
<figcaption>Level Overview</figcaption>
</figure>
</div></div>
<hr>
<h2>My contributions</h2>
<p>I mostly worked on some of the models, animations, particle effects and bug fixes. Below is just a small showcase of those items.</p>
<h3>Weed Killer Pickups</h3>
<p>These 2 models are the pickups you get when you kill a player:</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/5//gallery/Largeweedkiller.png" data-size="725x725"><img loading="lazy" src="https://patcave.me/media/posts/5//gallery/Largeweedkiller-thumbnail.png" alt="" width="720" height="720"></a>
<figcaption>Large Weed Killer Pickup</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/5//gallery/Weedkillersmall.png" data-size="725x725"><img loading="lazy" src="https://patcave.me/media/posts/5//gallery/Weedkillersmall-thumbnail.png" alt="" width="720" height="720"></a>
<figcaption>Small Weed Killer Pickup</figcaption>
</figure>
</div></div>
<p>Here is a video timelapse of the modeling and texturing process:<div class="post__iframe"><iframe loading="lazy" width="560" height="314" src="https://www.youtube.com/embed/Q1kpbwl7Lko" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></div>
<hr>
<h3 class="align-left">Pumpkin monster breathing animations</h3>
<p>Another thing I did was the pumpkin idle animations to make it feel more "alive". Before it just kinda sat there completely still, it didn't feel like it was really a monster.</p>
<p>Basically I gave the big areas some up and down movement, and added bones to each tumor to make them appear to be pulsing.</p>
<figure class="post__video"><video loading="lazy" width="300" height="150" controls="controls" data-mce-fragment="1">
<source src="https://cdn.discordapp.com/attachments/279748353343094784/886125731107700746/2021-09-10_23-46-30.mp4" type="video/mp4" /></video></figure>
<p>This was surprisingly difficult because Source engine requires the use of "bones" and each bone can rigidly deform a set of vertices near by it. Making a "rig" for basically a sphere is a bit unconventional. It works though! </p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/5/gallery/Screenshot_145.png" data-size="1919x1049"><img loading="lazy" src="https://patcave.me/media/posts/5/gallery/Screenshot_145-thumbnail.png" alt="" width="720" height="394"></a>
<figcaption>Gourdon Rig</figcaption>
</figure>
</div></div>
<hr>
<h3>Pumpkin monster death effects</h3>
<p>This is the full "death" effect I did for the pumpkin monster (named "Gourdon")</p>
<figure class="post__video"><video loading="lazy" width="300" height="150" controls="controls" data-mce-fragment="1">
<source src="https://cdn.discordapp.com/attachments/823623265796751370/887521282147647528/2021-09-14_20-12-14.mp4" type="video/mp4" /></video></figure>
<p>This effect was created using a physics simulation inside of Blender along side a technique called "cell fracture" where you randomly split the model into smaller "cells". </p>
<p>Big shoutout to a Blender plugin called <a href="https://github.com/bonjorno7/SourceOps">SourceOps </a>for making it easy to import level geometry into Blender!</p>
<figure class="post__video"><video loading="lazy" width="300" height="150" controls="controls" data-mce-fragment="1">
<source src="https://cdn.discordapp.com/attachments/709803812881170607/886865559445205062/2021-09-13_00-45-54.mp4" type="video/mp4" /></video></figure>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/5/gallery/Screenshot_159.png" data-size="1919x1049"><img loading="lazy" src="https://patcave.me/media/posts/5/gallery/Screenshot_159-thumbnail.png" alt="" width="720" height="394"></a>
<figcaption>Gibs</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/5/gallery/Screenshot_153.png" data-size="1919x1049"><img loading="lazy" src="https://patcave.me/media/posts/5/gallery/Screenshot_153-thumbnail.png" alt="" width="720" height="394"></a>
<figcaption>Particle Effects</figcaption>
</figure>
</div></div>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Game Server Monitoring </title>
        <author>
            <name>Patrick Hennessy</name>
        </author>
        <link href="https://patcave.me/game-server-monitoring/"/>
        <id>https://patcave.me/game-server-monitoring/</id>
            <category term="Programming Stuff"/>
            <category term="Gaming"/>

        <updated>2022-01-28T22:24:02-07:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://patcave.me/media/posts/9/Screenshot_1.png" alt="" />
                    I was brought on to the TF2Maps.net staff team to bring my technical expertise to help maintain and improve the state of our systems. The first thing I did in order to get an idea of how the servers were used was to install some&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <img src="https://patcave.me/media/posts/9/Screenshot_1.png" alt="" />
                <p>I was brought on to the <a href="https://tf2maps.net/">TF2Maps.net</a> staff team to bring my technical expertise to help maintain and improve the state of our systems. </p>
<p>The first thing I did in order to get an idea of how the servers were used was to install some monitoring software. </p>
<hr>
<h2>Tools that have previously failed me</h2>
<p>I've had previous experience with a bunch of different tools, but none of them I was really a big fan of, they all have annoying limitations. I've used all of these tools at one point in my career:</p>
<ul>
<li><a href="https://www.influxdata.com/time-series-platform/">TICK stack</a></li>
<li><a href="https://www.nagios.org/">Nagios</a></li>
<li><a href="https://aws.amazon.com/cloudwatch/">AWS Cloudwatch</a><a href="https://sensu.io/"></a></li>
<li><a href="https://sensu.io/">Sensu</a></li>
<li><a href="https://www.sumologic.com/">Sumologic</a></li>
<li><a href="https://www.elastic.co/what-is/elk-stack">ELK stack</a></li>
</ul>
<p>The TICK stack is nice except their dashboarding tool is really lacking in a lot of ways, and their query language is not as nice for more complex use cases. ELK stack has a huge amount of overhead to get it setup well, but a good ELK setup is defiantly really nice. Nagios is just... well... Nagios, not much needs to be said that has been said to death already. Cloudwatch I want to like, but its obviously AWS specific and it's dashboarding is really limited as well. Even pulling metrics from it into Grafana is still really hard to use meaningfully. Infact, as recently as 6 months ago, I tried to do just this but I couldn't find even a documentation page on their query syntax. </p>
<hr>
<h2>Enter Prometheus</h2>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/9/1200px-Prometheus_software_logo.svg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/9/responsive/1200px-Prometheus_software_logo.svg-xs.png 300w ,https://patcave.me/media/posts/9/responsive/1200px-Prometheus_software_logo.svg-sm.png 480w ,https://patcave.me/media/posts/9/responsive/1200px-Prometheus_software_logo.svg-md.png 768w ,https://patcave.me/media/posts/9/responsive/1200px-Prometheus_software_logo.svg-lg.png 1024w ,https://patcave.me/media/posts/9/responsive/1200px-Prometheus_software_logo.svg-xl.png 1360w ,https://patcave.me/media/posts/9/responsive/1200px-Prometheus_software_logo.svg-2xl.png 1600w"  alt="" width="183" height="181"></figure>
<p>For the longest time; I was confused at how <a href="https://prometheus.io/">Prometheus</a> worked, and they way they explain its "no long term storage" thing I think turned me off for a long time on it. </p>
<p>I thought I'd give it a try on the recommendation of a co-worker and it being probably the only tool I haven't yet tried for monitoring.</p>
<p><a href="https://grafana.com/pricing/">Grafana cloud</a> also has a free tier offering that was enough for me to test stuff out with! </p>
<p>The storage thing is basically just that they don't retain metrics forever and also don't offer any kind of highly available or redundant storage solution. This is fine for my use case, but may not be suitable for everyone.</p>
<hr>
<h2>What to track?</h2>
<p>So I will be monitoring our 4 <a href="https://wiki.teamfortress.com/wiki/Linux_dedicated_server">Team Fortress 2 game servers</a>. </p>
<p>Currently they run on <a href="https://en.wikipedia.org/wiki/Colocation_centre">co-located</a> hardware. 2 in New York and 2 in Frankfurt. Each server has its own distinct hostname (DNS resolvable), so I can use that as a "key" to filter by each instance. </p>
<p>Basically I just want to have some insight to what is going on the server when I'm not directly logged in and so we can analyze historical events like server crashes or moderation events.</p>
<h5>Instance metrics</h5>
<ul>
<li>CPU Metrics</li>
<li>Memory Use</li>
<li>Disk Space and IO</li>
<li>Network IO, packet loss, bandwidth usage</li>
</ul>
<h5>Process metrics</h5>
<ul>
<li>Is the srcds process even running?</li>
<li>How long has the srcds process been running</li>
</ul>
<h5>Game Server stats</h5>
<ul>
<li>Current player count</li>
<li>Current level server is set to</li>
<li>Histogram of player activity</li>
<li>Histogram of levels played</li>
</ul>
<hr>
<h2>How to gather metrics with Prometheus?</h2>
<p>To my surprise, this is actually quite easy to do, every other tool I've used is very cumbersome to setup. Each of the buckets of metrics I want can be grabbed basically out of the box using <a href="https://prometheus.io/docs/instrumenting/exporters/">Prometheus exporters</a>. Here are the exporters I used:</p>
<ul>
<li><a href="https://github.com/prometheus/node_exporter">Node Exporter</a> - Stats about the machine itself.</li>
<li><a href="https://github.com/ncabatoff/process-exporter">Process Exporter</a> - Stats about specific processes on the machine</li>
<li><a href="https://github.com/galexrt/srcds_exporter">Srcds Exporter</a> - Specific to srcds data like map name, player count, etc.</li>
</ul>
<p>You basically give each one a config file to read a few variables like telling it how to find the process it needs to watch or information about the hostname and most importantly, the Prometheus instance to publish them to. </p>
<p>Now this is the part that was confusing for me at first. You need to run a local Prometheus on the server in order to publish / replicate the metrics to a remote one that does the actual aggregation. In this case, my local Prometheus published to the one hosted by Grafana Cloud. </p>
<p>On a small aside, I'll also say the Grafana Cloud docs are fantastic for setting this up and I had absolutely no issues getting going with it.</p>
<p>Below are snippets from my config files (node_exporter needs no config):</p>
<pre><span style="text-decoration: underline;"><em><strong>process_exporter.yml<br></strong></em></span><br>---<br>process_names:<br>  - name: "srcds_linux"<br>    exe:<br>    - tmux<br>    cmdline:<br>    - new -d -s tf .*</pre>
<pre><span style="text-decoration: underline;"><em><strong>srcds_exporter.yml</strong></em></span><br><br>---<br>options:<br>  rcontimeout: 60s<br>  cachetimeout: 15s<br>servers:<br>  us.tf2maps.net:<br>    address: 172.93.228.253:27015<br>    rconpassword: ***password***</pre>
<hr>
<h2>Logging Admin Actions</h2>
<p>TF2 servers often run modding platforms that come with an ecosystem of plugins for doing administrative actions. One very popular platform is called <a href="https://www.sourcemod.net/">SourceMod</a>. Many of the built-in plugins will log important information like administrator actions to a log file that I can parse. Obviously logs are not like metrics that can be measured every minute, log files get new lines at random intervals, so it requires a different tool.</p>
<p>Thankfully, Prometheus has an answer to this! In order to scrape logs you have to run another service called <a href="https://grafana.com/oss/loki/">Loki</a>, which is advertised as "Prometheus but for logs". Grafana Cloud's free tier also comes with Loki access. Awesome!</p>
<p>To actually export to Loki, you need to run a Prometheus style exporter called <a href="https://grafana.com/docs/loki/latest/clients/promtail/">Promtail</a>. </p>
<p>Now, most people who know me know that I'm a wizard with <a href="https://en.wikipedia.org/wiki/Regular_expression">Regular Expressions</a>, though admittedly this one took me a while to get right. Whoever created this log format clearly did not intend for it to be parsed. (Aside: Lea Verou has a great <a href="http://projects.verou.me/regexplained/">RegEx testing tool</a> that I highly recommend for this kind of task.)</p>
<p>Below is the full config I used to parse the SourceMod log files. (I would have really preferred JSON, but SourceMod has been around since before JSON was a thing)</p>
<pre>  pipeline_stages:<br>  - match:<br>      selector: '{job="sourcemod"}'<br>      stages:<br>      - regex:<br>          expression: 'L (?P&lt;timestamp&gt;\d{2}\/\d{2}\/\d{4} - \d{2}:\d{2}:\d{2}): \[(?P&lt;plugin&gt;.*\.smx)\] \"(?P&lt;user_name&gt;[A-Za-z0-9\ ]+)&lt;\d+&gt;&lt;(?P&lt;steam_id&gt;\[U:[0-9]:[0-9]+\])&gt;&lt;[\d\w]{0,}&gt;" (?P&lt;message&gt;.*)'<br>      - labels:<br>          plugin:<br>          user_name:<br>          steam_id:<br>      - timestamp:<br>          format: '01/02/2006 - 15:04:05'<br>          source: timestamp<br>      - output:<br>          source: message<br>  - match:<br>      selector: '{job="sourcemod",plugin!~".*.smx"}'<br>      stages:<br>      - drop:<br>          expression: ".*"<br><br>  static_configs:<br>  - labels:<br>      job: sourcemod<br>      __path__: /home/tf/tf/addons/sourcemod/logs/L*.log</pre>
<p>This basically pulls out the timestamp, plugin name, user name, their steam id, and the actual log message.</p>
<hr>
<h2>Configuring Grafana</h2>
<p>Now that we're collecting these stats, we need to display them! Prometheus does not have a tool for this themselves. The obvious choice here is Grafana, especially because they're very well integrated cloud free tier.</p>
<p>They have a really nice query builder / explorer to use. Very intuitive, and works well with both Prometheus and Loki out of the box. For most simple queries you can just click a few buttons and get what you want without having to even learn <a href="https://prometheus.io/docs/prometheus/latest/querying/basics/">PromQL</a>.</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/9/gallery/Screenshot_4.png" data-size="1544x931"><img loading="lazy" src="https://patcave.me/media/posts/9/gallery/Screenshot_4-thumbnail.png" alt="" width="720" height="434"></a></figure>
</div></div>
<p>For the actual dashboard panels, I wanted to be able to filter by host. You basically just setup a dashboard variable and then you can use it as a variable in your queries:</p>
<pre>srcds_playercount_humans{instance=~"$host"}<br>time() - namedprocess_namegroup_oldest_start_time_seconds{instance=~"$host"}</pre>
<p>Most panels were very easy to setup. Infact most of them were just simple 1 liners just like the queries in the above code.</p>
<p>The Admin log required 3 transforms to display how I wanted. Filtering out unwanted messages, setting up the table fields, and a labels to fields transform.</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="3">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/9/gallery/Screenshot_6.png" data-size="1193x830"><img loading="lazy" src="https://patcave.me/media/posts/9/gallery/Screenshot_6-thumbnail.png" alt="" width="720" height="501"></a></figure>
</div></div>
<p>The panel that gave me the most trouble was the "Map activity" panel.</p>
<p>It is intended to show the history of the maps played. To get this to work, I had to use the deprecated version of their Graph panel, and setup a transform that converts a Prometheus label to the legend of the graph. If that sounds confusing, that's because it is. I basically monte carlo'd it into working.</p>
<p> ¯\_(ツ)_/¯</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="3">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/9/gallery/Screenshot_5.png" data-size="451x197"><img loading="lazy" src="https://patcave.me/media/posts/9/gallery/Screenshot_5-thumbnail.png" alt="" width="451" height="197"></a></figure>
</div></div>
<hr>
<h2>Full Dashboard</h2>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/9/gallery/Screenshot_1.png" data-size="1546x903"><img loading="lazy" src="https://patcave.me/media/posts/9/gallery/Screenshot_1-thumbnail.png" alt="" width="720" height="421"></a></figure>
</div></div>
<p>One thing to mention is that I also have a panel that is tracking the "time in use" stat. This is calculated by time spent running with at least 1 person connected; expressed as a percent. As you can see, we only actually use the servers very little compared to how long they run, and that's a generous number because simply having 1 player on the server doesn't really mean its "in use". This is part of a larger case I'm making for <a href="https://patcave.me/automate-all-the-things/">ad-hoc servers</a>.</p>
<hr>
<h2>Takeaways from the data</h2>
<p>Like I said above, I am tracking a number of stats so I can better determine our hardware needs in the future. Given our budget is extraordinarily low, we need to take as many optimizations as we can get. </p>
<p>The key takeaways I've gotton from this:</p>
<ul>
<li>The server is idle <em>way</em> too much. Ad-hoc servers would solve this problem</li>
<li>Our bandwidth is higher than I expected
<ul>
<li>Could be optimized by not having to keep a copy of a map on each server, but instead share a file system using something like EFS</li>
</ul>
</li>
<li>We're overprovisioned on CPU, RAM and Disk
<ul>
<li>We never go above 10% cpu use, and we have 2 cores available. A VM with a single core should be more than enough.</li>
<li>RAM use can get high at times, but that is a function of us running 2 srcds servers on the same VM. We could happily cut the provisioned RAM in half and be fine</li>
<li>We just don't need a huge disk. We can do a better job of clearing out <code>.dem</code> files (game recordings) and clean out maps after they're been played in our map tests. Disks are fairly cheap though I suppose</li>
</ul>
</li>
</ul>
<hr>
<h2>Alerting?</h2>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/9/Screenshot_7.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/9/responsive/Screenshot_7-xs.png 300w ,https://patcave.me/media/posts/9/responsive/Screenshot_7-sm.png 480w ,https://patcave.me/media/posts/9/responsive/Screenshot_7-md.png 768w ,https://patcave.me/media/posts/9/responsive/Screenshot_7-lg.png 1024w ,https://patcave.me/media/posts/9/responsive/Screenshot_7-xl.png 1360w ,https://patcave.me/media/posts/9/responsive/Screenshot_7-2xl.png 1600w"  alt="" width="315" height="253"></figure>
<p>Now that I'm tracking this information, can I meaningfully alert off of it?</p>
<p>Prometheus does have a tool called <a href="https://prometheus.io/docs/alerting/latest/alertmanager/">AlertManager</a> for this task, but I must say this tool is very clunky to use, but even so I was able to get alerts working and publishing to our <a href="https://discord.com/">Discord</a> server.</p>
<p> </p>
<p>My big complaint with it is that you have to have a graph that is specific to a metric and setup as an "alarm graph" in order to alarm off of. In other words, I can't use my existing panels because alert manager doesn't like the <code>$host</code> filter. So I have to make a new dashboard just for alerts. </p>
<p>There is a big lack of customization for the data it shares with Discord and doesn't do a great job of keeping users informed when an alarm clears or is "acked". Also testing the whole alarming setup is really difficult and slow. It does feel like it was designed for a specific team and use case.</p>
<p>Honestly I'm probably better off using PagerDuty, but I'm not sure how to actually get the data out of Prometheus and into PagerDuty. </p>
<hr>
<h2>In summation</h2>
<p>I have to say that I am pleasantly surprised at how easy this all was to get setup with. Prometheus and Grafana both have done a great job with their documentation and designing their tools for engineers. However their alerting solution could use some work in my opinion. </p>
<p>I'm happy with this level of success in this small effort because it's a prototype for things I may possibly bring into my work one day. </p>
<p>There is a synergy in solving problems for TF2Maps. Often at work I don't get as many opportunities as I like to just experiment with new tools. It make sense why we don't just constantly prototype new tools, but in doing so we do sometimes miss valuable setup's like this. </p>
<p>I would absolutely recommend the Prometheus + Loki + Grafana stack for anyone running game servers, not just Source servers.</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Procedural Texture creation</title>
        <author>
            <name>Patrick Hennessy</name>
        </author>
        <link href="https://patcave.me/procedural-texture-creation/"/>
        <id>https://patcave.me/procedural-texture-creation/</id>
            <category term="Level Design"/>
            <category term="Gaming"/>

        <updated>2022-01-28T20:59:05-07:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://patcave.me/media/posts/8/franklin-rell-materialvol22.jpg" alt="" />
                    For a while now i've been learning to use a program called Substance Designer. It allows you to procedurally and nondestructively create textures for 3D programs to use. For me i've been trying to use it to emulate the Team Fortress 2 Style. There's been&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <img src="https://patcave.me/media/posts/8/franklin-rell-materialvol22.jpg" alt="" />
                <p>For a while now i've been learning to use a program called <a href="https://www.adobe.com/products/substance3d-designer.html">Substance Designer</a>. It allows you to procedurally and nondestructively create textures for 3D programs to use. For me i've been trying to use it to emulate the <a href="https://polycount.com/discussion/73559/texturing-for-team-fortress-2-a-short-guide">Team Fortress 2 Style</a>.</p>
<hr>
<h2>Node Workflow</h2>
<p>There's been a few programs i've used in the last few years that use a node based workflow. Blender, Davinci Resolve Fusion and now Substance; so this felt very natural to me. </p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8//gallery/tf_snow_graph.png" data-size="1167x515"><img loading="lazy" src="https://patcave.me/media/posts/8//gallery/tf_snow_graph-thumbnail.png" alt="" width="720" height="318"></a></figure>
</div></div>
<p>Basiccaly you start on the leftmost part of the graph with something that produces a basic texture. These are usually <a href="https://en.wikipedia.org/wiki/Perlin_noise">procedrual noise</a> textures or shape nodes.</p>
<p>Just like with a painting or any kind of "art", you start with very rough and basic shapes, and slowly add in detail over time. </p>
<p>The set of nodes provided by Substance allow an artist to do mathematical transforms such as warps, blurs, blending with other sub graphs, color transformations, masking and a lot more. </p>
<p>The coolest thing about it being procedural is that you can change the inputs at the beginning of the graph and can produce a lot of variation. These textures all are produced using the same procedure, but just have different base shape inputs:</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="4">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/castle1-2.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/castle1-2-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/castle2-2.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/castle2-2-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/castle3-3.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/castle3-3-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/castle4-3.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/castle4-3-thumbnail.png" alt="" width="720" height="720"></a></figure>
</div></div>
<p>Also technically all the nodes produce <a href="https://en.wikipedia.org/wiki/Vector_graphics">vectorized graphics</a> under the hood, so you can scale your texture output to insane numbers like 16k x 16k. (For TF2 you generally work at 1024 or 512).</p>
<hr>
<h2>Maps, maps, maps</h2>
<p>For Team Fortress 2, you generally work with diffuse textures, which is essentially just color with <a href="https://en.wikipedia.org/wiki/Ambient_occlusion">ambient occlusion</a> baked onto it.</p>
<p>However substance is able to produce a wide variety of other maps useful for TF2.</p>
<h3>Specular</h3>
<p>Otherwise known as roughness; this is telling a renderer how shiney something should be. Or how much of the world to reflect on it's surface.</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/Screenshot_2.png" data-size="671x561"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/Screenshot_2-thumbnail.png" alt="" width="671" height="561"></a>
<figcaption>high specular</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/Screenshot_3.png" data-size="674x574"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/Screenshot_3-thumbnail.png" alt="" width="674" height="574"></a>
<figcaption>low specular</figcaption>
</figure>
</div></div>
<h3>Normal</h3>
<p>Normal maps are extremely useful and powerful and used almost everywhere.</p>
<p>Basically they allow an object to catch lighting without actually having any extra geometry. This is very powerful because calculating how light will hit a 3D object's face is relatively expensive (which is why game engines want low poly objects).</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/Screenshot_5.png" data-size="663x568"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/Screenshot_5-thumbnail.png" alt="" width="663" height="568"></a>
<figcaption>no normal map</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/Screenshot_6.png" data-size="666x571"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/Screenshot_6-thumbnail.png" alt="" width="666" height="571"></a>
<figcaption>with normal map</figcaption>
</figure>
</div></div>
<p>Normal maps do have their limitations though. If you view them really close up you can tell that it's actually just a flat plane instead of the geometery. They work best on adding small details like cracks, indentations or clothing folds but shouldn't be use to do larger details that need real geometry.</p>
<h3>Height</h3>
<p>One thing that I can't use because Source Engine simply doesn't support it is Height Maps. Substance Designer is very powerful with the addition of height maps. Basically they're black and white images that tell a renderer where to "push out" geometery. </p>
<p>Here is an example that demonstrates it this very powerful feature:</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/Screenshot_1.png" data-size="670x565"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/Screenshot_1-thumbnail.png" alt="" width="670" height="565"></a>
<figcaption>Rendered material</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/legoheight.png" data-size="2048x2048"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/legoheight-thumbnail.png" alt="" width="720" height="720"></a>
<figcaption>height map</figcaption>
</figure>
</div></div>
<h3>Other Maps</h3>
<ul>
<li><a href="https://developer.valvesoftware.com/wiki/$blendmodulatetexture">Blend Modulation</a> - Source Engine's way to blend between 2 different textures</li>
<li>Emissive - Source Engine allows a "self illumination" property so something looks like it glows while the object itself doesn't emit light</li>
</ul>
<hr>
<h2>My First Textures with Substance</h2>
<p>Okay, as usual my first attempts were horrendous, but its a learning process right?</p>
<table class="align-left" style="border-collapse: collapse; width: 100%; height: 157px; border-style: hidden;" border="0">
<tbody>
<tr style="height: 230px;">
<td style="width: 34.9373%; height: 10px;">
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/bark-2.png" data-size="2048x2048"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/bark-2-thumbnail.png" alt="" width="720" height="720"></a></figure>
</div></div>
</td>
<td style="width: 65.0627%; height: 10px;">
<p> </p>
<p>This was a wood bark texture I tried to make, quite unsuccessfully i admit. Though with this one I do think i got a rough gist of wood, perhaps adjusting the colors a bit would help sell it better. Though either way this def does not fit into TF2.</p>
</td>
</tr>
<tr style="height: 344px;">
<td style="width: 34.9373%; height: 86px;">
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/sand-2.png" data-size="2048x2048"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/sand-2-thumbnail.png" alt="" width="720" height="720"></a></figure>
</div></div>
</td>
<td style="width: 65.0627%; height: 86px;">
<p> </p>
<p>This was an attempt to make sand. I think I got the general wavy flow of sand but <span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">actually getting the "grainy-ness" of it it a lot harder, and defiantly not as easy as just </span><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">adding a bunch of little dots everywhere haha.</span></p>
</td>
</tr>
<tr style="height: 344px;">
<td style="width: 34.9373%; height: 10px;">
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/dirt-2.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/dirt-2-thumbnail.png" alt="" width="720" height="720"></a></figure>
</div></div>
</td>
<td style="width: 65.0627%; height: 10px;">
<p> </p>
<p>I'm happy to call this one a complete failure. This is intended to be a dirt texture. I'm not even sure what I was thinking making it, but again; you gotta have these failures so you can get a feel for the tool and learn how to do things better over time.</p>
</td>
</tr>
<tr style="height: 344px;">
<td style="width: 34.9373%; height: 51px;">
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/floortile.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/floortile-thumbnail.png" alt="" width="720" height="720"></a></figure>
</div></div>
</td>
<td style="width: 65.0627%; height: 51px;">
<p> </p>
<p>This one is a tile floor texture I tried to replicate, its got the basic shapes but it's <span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">missing the dirty floor look like the in game one has.</span></p>
</td>
</tr>
</tbody>
</table>
<p>With all of these, its just baby steps. One thing I think i've done well in my life is embrace the learning process and accept that at the beginning of some new endeavor that I'm going to suck at it, but as long as I'm seeking to improve and being critical of my failures and understanding why I failed, then I improve quite quickly. </p>
<p>These textures were my first steps; attempts that I made within a few weeks of owning the software. The next section is textures I made after a few months of continued practice.</p>
<hr>
<h2>Showcasing my "better" textures</h2>
<p>Below is some textures and the graph for them that i've made after a few months of using Substance. These are much closer to the artstyle for TF2 and some of these I think could be used in game quite well.</p>
<table style="border-collapse: collapse; width: 100%; height: 595px; border-style: hidden;" border="0">
<tbody>
<tr style="height: 273px;">
<td style="width: 33.3333%; height: 117px;">
<p><strong>Wood</strong></p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8//gallery/tf_wood.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8//gallery/tf_wood-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8//gallery/tf_wood_graph.png" data-size="4063x1635"><img loading="lazy" src="https://patcave.me/media/posts/8//gallery/tf_wood_graph-thumbnail.png" alt="" width="720" height="290"></a></figure>
</div></div>
<p> </p>
</td>
<td style="width: 33.3333%; height: 117px;">
<p><strong>Grass</strong></p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8//gallery/tf_grass.png" data-size="2048x2048"><img loading="lazy" src="https://patcave.me/media/posts/8//gallery/tf_grass-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8//gallery/tf_grass_graph.png" data-size="1939x1059"><img loading="lazy" src="https://patcave.me/media/posts/8//gallery/tf_grass_graph-thumbnail.png" alt="" width="720" height="393"></a></figure>
</div></div>
<p> </p>
</td>
<td style="width: 33.3333%; height: 117px;">
<p><strong><strong>Snow</strong></strong></p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8//gallery/tf_snow.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8//gallery/tf_snow-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8//gallery/tf_snow_graph-2.png" data-size="1167x515"><img loading="lazy" src="https://patcave.me/media/posts/8//gallery/tf_snow_graph-2-thumbnail.png" alt="" width="720" height="318"></a></figure>
</div></div>
</td>
</tr>
<tr style="height: 219px;">
<td style="width: 33.3333%; height: 219px;"><strong><strong> Truss</strong></strong>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/tf_truss.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/tf_truss-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/tf_truss_graph.png" data-size="3091x1763"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/tf_truss_graph-thumbnail.png" alt="" width="720" height="411"></a></figure>
</div></div>
</td>
<td style="width: 33.3333%; height: 219px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;">Cliff Wall</span></span>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/tf_cliff.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/tf_cliff-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/tf_cliff_graph.png" data-size="3571x1379"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/tf_cliff_graph-thumbnail.png" alt="" width="720" height="278"></a></figure>
</div></div>
</td>
<td style="width: 33.3333%; height: 219px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;">Bamboo</span></span>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/bamboo.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/bamboo-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/bamboo_graph.png" data-size="2003x1027"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/bamboo_graph-thumbnail.png" alt="" width="720" height="369"></a></figure>
</div></div>
</td>
</tr>
<tr style="height: 219px;">
<td style="width: 33.3333%; height: 111px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;">Herringbone Bamboo</span></span>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/herringbone.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/herringbone-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/herringbone_grpah.png" data-size="3539x1348"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/herringbone_grpah-thumbnail.png" alt="" width="720" height="274"></a></figure>
</div></div>
</td>
<td style="width: 33.3333%; height: 111px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;">Chesterfield</span></span>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/chesterfield.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/chesterfield-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/chesterfield_graph-2.png" data-size="3538x1330"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/chesterfield_graph-2-thumbnail.png" alt="" width="720" height="271"></a></figure>
</div></div>
</td>
<td style="width: 33.3333%; height: 111px;"> <span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;">Gold Coins</span></span>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/coins.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/coins-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/coin_graph.png" data-size="5048x2546"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/coin_graph-thumbnail.png" alt="" width="720" height="363"></a></figure>
</div></div>
</td>
</tr>
<tr style="height: 245px;">
<td style="width: 33.3333%; height: 148px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;">Arrow Sign (recreation)</span></span></span></span>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/arrow_sign.png" data-size="1024x512"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/arrow_sign-thumbnail.png" alt="" width="720" height="360"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/arrow_sign_graph.png" data-size="2515x1315"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/arrow_sign_graph-thumbnail.png" alt="" width="720" height="376"></a></figure>
</div></div>
<span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"><br></span></span></td>
<td style="width: 33.3333%; height: 148px;">
<p><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"><span style="font-weight: var(--font-weight-bold); font-size: 18.4px;"> Stone Wall</span></span></p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/castle1.png" data-size="1024x1024"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/castle1-thumbnail.png" alt="" width="720" height="720"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/stonewall_graph.png" data-size="7892x2371"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/stonewall_graph-thumbnail.png" alt="" width="720" height="216"></a></figure>
</div></div>
</td>
<td style="width: 33.3333%; height: 148px;"> </td>
</tr>
</tbody>
</table>
<hr>
<h2>Crazy Stuff Expert Artists have Made</h2>
<p>These all blow my mind that it's possible to do this all procedurally but here we are. I feel very inadequate compared to these guys, but then again they're all professionals. I do think admiring art of people who are better than you at it is a great way to learn and inspire. I'll also say that all of these look way more impressive because they have the benefit of using height maps, which makes it look a lot better than the flat stuff I do, but as said before, I can't use height because TF2's Source Engine branch does not support it unfortunately. Nonetheless these are all very impressive.</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="4">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/daniel-thiger-spagetthi-sphere-b.jpg" data-size="1920x1920"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/daniel-thiger-spagetthi-sphere-b-thumbnail.jpg" alt="" width="720" height="720"></a>
<figcaption>https://www.artstation.com/artwork/gJV9bL</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/james-ritossa-padding-r-03.jpg" data-size="1920x1920"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/james-ritossa-padding-r-03-thumbnail.jpg" alt="" width="720" height="720"></a>
<figcaption>https://www.artstation.com/artwork/19P8L</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/javier-perez-jperez-tiki-01.jpg" data-size="1920x3240"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/javier-perez-jperez-tiki-01-thumbnail.jpg" alt="" width="720" height="1215"></a>
<figcaption>https://www.artstation.com/artwork/58RxrE</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/jonathan-benainous-sphere-01.jpg" data-size="1920x2054"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/jonathan-benainous-sphere-01-thumbnail.jpg" alt="" width="720" height="770"></a>
<figcaption>https://www.artstation.com/artwork/P9WN1</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/ke-liu-screenshot054.jpg" data-size="1920x1080"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/ke-liu-screenshot054-thumbnail.jpg" alt="" width="720" height="405"></a>
<figcaption>https://www.artstation.com/artwork/Z5QJ50</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/vladimir-fedorenko-preview-color.jpg" data-size="1441x1440"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/vladimir-fedorenko-preview-color-thumbnail.jpg" alt="" width="720" height="720"></a>
<figcaption>https://www.artstation.com/artwork/gJRmvP</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/3dextrude-tutorials-02.jpg" data-size="1920x731"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/3dextrude-tutorials-02-thumbnail.jpg" alt="" width="720" height="274"></a>
<figcaption>https://www.artstation.com/artwork/48e1E4</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/daniel-thiger-popsicle-render-a.jpg" data-size="1440x1440"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/daniel-thiger-popsicle-render-a-thumbnail.jpg" alt="" width="720" height="720"></a>
<figcaption>https://www.artstation.com/artwork/mq2bO8</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/james-ritossa-sphere.jpg" data-size="1920x1920"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/james-ritossa-sphere-thumbnail.jpg" alt="" width="720" height="720"></a>
<figcaption>https://www.artstation.com/artwork/1n18g2</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/ke-liu-screenshot000.jpg" data-size="1920x1920"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/ke-liu-screenshot000-thumbnail.jpg" alt="" width="720" height="720"></a>
<figcaption>https://www.artstation.com/artwork/1nJRRX</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/clark-coots-screenshot072.jpg" data-size="1080x1080"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/clark-coots-screenshot072-thumbnail.jpg" alt="" width="720" height="720"></a>
<figcaption>https://www.artstation.com/artwork/e0WJgw</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/8/gallery/imanol-delgado-port2222.jpg" data-size="1920x1079"><img loading="lazy" src="https://patcave.me/media/posts/8/gallery/imanol-delgado-port2222-thumbnail.jpg" alt="" width="720" height="405"></a>
<figcaption>https://www.artstation.com/artwork/XoxBY</figcaption>
</figure>
</div></div>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Learning 3D Modeling for TF2</title>
        <author>
            <name>Patrick Hennessy</name>
        </author>
        <link href="https://patcave.me/learning-3d-modeling-for-video-games/"/>
        <id>https://patcave.me/learning-3d-modeling-for-video-games/</id>
            <category term="Level Design"/>
            <category term="Gaming"/>

        <updated>2022-01-27T14:07:21-07:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://patcave.me/media/posts/7/20200515140446_1.jpg" alt="" />
                    For a while now i've been working on level design projects at TF2Maps.net, and something that has been a huge need in the community is getting models for the game tailored to certain game play needs or to fit into a theme. Having run into&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <img src="https://patcave.me/media/posts/7/20200515140446_1.jpg" alt="" />
                <p>For a while now i've been working on level design projects at <a href="https://tf2maps.net/">TF2Maps.net</a>, and something that has been a huge need in the community is getting models for the game tailored to certain game play needs or to fit into a theme. </p>
<p>Having run into this kind of problem myself I decided to take it on myself to learn modeling. I'm the kind of person who goes way out of his way to help fill a need for whatever organization I'm in.</p>
<hr>
<h2>Humble beginnings</h2>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/7/blender_community_badge_orange.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/7/responsive/blender_community_badge_orange-xs.png 300w ,https://patcave.me/media/posts/7/responsive/blender_community_badge_orange-sm.png 480w ,https://patcave.me/media/posts/7/responsive/blender_community_badge_orange-md.png 768w ,https://patcave.me/media/posts/7/responsive/blender_community_badge_orange-lg.png 1024w ,https://patcave.me/media/posts/7/responsive/blender_community_badge_orange-xl.png 1360w ,https://patcave.me/media/posts/7/responsive/blender_community_badge_orange-2xl.png 1600w"  alt="" width="214" height="279"></figure>
<p>First, I chose to use a program called <a href="https://www.blender.org/">Blender</a> to do my modeling, and that is because it's completely free and very well featured.</p>
<p>After following a few tutorials and getting to know the program, I volunteered to make a "<a href="https://collinsvisualmedia.com/hero-props-description">hero prop</a>" for the map <a href="https://tf2maps.net/downloads/kelly.9294/">ctf_kelly</a>. The map's author (MegapiemanPHD) published dev log videos and said he will at some point want a prop made for the center piece, so I just contacted him and offered to do it.</p>
<p>Basically the idea was it was a giant bronze globe as a centerpeice for a retro futuristic plaza. This would turn out to challenge my very new skills a lot, but as such I learned a great deal from this.</p>
<hr>
<h2>First Iteration</h2>
<p>Having no idea what I would actually make, (no concept art or anything), I just searched on ArtStation for "globes" and tried to emulate what I saw. The big common elements I saw were the grid like sphere with contients on the outside, so that was the rough plan.</p>
<p>This was the first attempt I made at making it:</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/ss.png" data-size="1919x1053"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/ss-thumbnail.png" alt="" width="720" height="395"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/ss2.png" data-size="1919x1053"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/ss2-thumbnail.png" alt="" width="720" height="395"></a></figure>
</div></div>
<p>The next part was getting it into the game engine, which was a lot harder than I expected. I used a Blender plugin called <a href="https://developer.valvesoftware.com/wiki/Blender_Source_Tools">Blender Source Tools</a> which allows you to export a mesh to the '.smd' format that Source engine requires. You also need to learn to write QC files and follow a process of 'compiling' the model data so the engine can actually use it. </p>
<p>After getting the mesh in engine and applying a very basic texture to it, this is what I had:</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/20200511125335_1.jpg" data-size="1920x1080"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/20200511125335_1-thumbnail.jpg" alt="" width="720" height="405"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/20200511150244_1.jpg" data-size="1920x1080"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/20200511150244_1-thumbnail.jpg" alt="" width="720" height="405"></a></figure>
</div></div>
<p>Yeah okay, so it looks not the best, a bit like chocolate, and is really <a href="https://en.wikipedia.org/wiki/Low_poly">low poly</a>, but hey I got something I made from scratch into the engine! This is a good but humble start.</p>
<p>So in order to make it not look so "chocolatey" I started learning about "shaders" in the engine. In this case, there were other inputs to the shader I wasn't using which would give it that <a href="https://en.wikipedia.org/wiki/Specular_reflection">specular sheen</a> I wanted. See the thing about 3D rendering is that you have different types of inputs. So mostly I was just using the color input, but to get it to actually reflect the world and have more of a gloss look to it, you needed to add a specular map. In my case I just uniformly applied it to the whole object.</p>
<p>This is the result with the specular map and cubemaps:</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/20200511165004_1.jpg" data-size="1920x1080"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/20200511165004_1-thumbnail.jpg" alt="" width="720" height="405"></a></figure>
</div></div>
<p>Defiantly an improvement; i'd believe that was a bronze metallic material. </p>
<hr>
<h2>Redoing the Model</h2>
<p>Megapieman and myself both felt the current model I had made looked too "off balance" and also given this was in gameplay space, players will be able to jump on or around this, so smoothing out the base to be more gameplay friendly was a good idea. I would end up redo-ing the model for this prop probably 5 times in total by the end.</p>
<p>This is what I came up with, basically having remodeled it from scratch a few times:</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/Screenshot_37-2.png" data-size="1919x1052"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/Screenshot_37-2-thumbnail.png" alt="" width="720" height="395"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/ss-2.png" data-size="1919x1053"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/ss-2-thumbnail.png" alt="" width="720" height="395"></a></figure>
</div></div>
<hr>
<h2>Texturing </h2>
<p>I only really put a basic texture on this thing, which was mostly just the bronze we saw before, but I did try a few techniques I know about "stylized" art.</p>
<ul>
<li>Gentle gradient that leads the eye up to a focal point. The base of objects is generally more "dirty" too</li>
<li>Edge wear on the edges</li>
<li>Scratches or other imperfections</li>
</ul>
<p>For texturing I tried doing it only using Blender since I felt that using Gimp (another program i'm very comfortable with) was too hard since I couldn't get a good preview of the peice easily.</p>
<p>This is the only screenshot I took from the texturing process:</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/ss-3.png" data-size="1919x1053"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/ss-3-thumbnail.png" alt="" width="720" height="395"></a></figure>
</div></div>
<hr>
<h2>Collision Meshes</h2>
<p>Collision meshes are very important for Source, especially since this is in gameplay space, meaning players will interact with it as if its a real object. </p>
<p>One caveat of the engine is that it can't and does not allow concave geometery for collision meshes. You basically have to create multiple discrete meshes that are strictly convex and stack them on each other. If you dont, then it just shrink wraps the collision mesh instead.</p>
<p>Here you can see my many attempts and frustations at getting this right:</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="4">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/globemesh2.jpg" data-size="891x652"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/globemesh2-thumbnail.jpg" alt="" width="720" height="527"></a>
<figcaption>Shrink wrapped cuz I made them concave</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/globemesh.jpg" data-size="793x441"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/globemesh-thumbnail.jpg" alt="" width="720" height="400"></a>
<figcaption>Collision mesh not aligned at all</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/Screenshot_17.png" data-size="923x700"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/Screenshot_17-thumbnail.png" alt="" width="720" height="546"></a>
<figcaption>Collision mesh very not aligned at all</figcaption>
</figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/Screenshot_1.png" data-size="1919x1079"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/Screenshot_1-thumbnail.png" alt="" width="720" height="405"></a>
<figcaption>Final "good" collision mesh</figcaption>
</figure>
</div></div>
<hr>
<h2>Animation</h2>
<p>Megapieman wanted the globe to spin. This seems easy, but is a lot more invovled than one might realize. You have to basically setup a bone rig in blender and have it animate based on key frames. Then you have to export your animation as a separate .smd and add more info to your QC file to tell it this has an animation and how to do it. This took me probably 2 weeks of troubleshooting and frustration to get working right.</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="2">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/Screenshot_7.png" data-size="1919x1051"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/Screenshot_7-thumbnail.png" alt="" width="720" height="394"></a></figure>
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/Screenshot_14.png" data-size="1919x1048"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/Screenshot_14-thumbnail.png" alt="" width="720" height="393"></a></figure>
</div></div>
<p>This is the result of all the animation work, just for a simple spin:</p>
<figure class="post__video"><video loading="lazy" width="300" height="150" controls="controls" data-mce-fragment="1">
<source src="https://cdn.discordapp.com/attachments/702085759477350460/711075301639061564/2020-05-15_23-31-55.mp4" type="video/mp4" /></video></figure>
<hr>
<h2>Final Result &amp; Learnings</h2>
<p>After having modeled and remodeled things on this several times I finally got it to what I call a finished state. I would say I learned quite a lot from doing this:</p>
<ul>
<li>How to get models into and out of TF2</li>
<li>Modeling using modifiers and procedural methods
<ul>
<li>Shrink wrap modifier on the continent</li>
<li>Array / mirror on the globe lattice</li>
</ul>
</li>
<li>UV unwrapping a complex object</li>
<li>Bone animation in Source</li>
<li>Basics of texturing</li>
<li>How to use the game shaders to apply texture to the model</li>
<li>Collision Meshes</li>
</ul>
<p>And probably dozens of other things I'm not even thinking about. As far as first projects go, I'd say this was a pretty good one, and now its used on the map!</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/7//gallery/20200515140446_1-2.jpg" data-size="1680x1050"><img loading="lazy" src="https://patcave.me/media/posts/7//gallery/20200515140446_1-2-thumbnail.jpg" alt="" width="720" height="450"></a></figure>
</div></div>
<p>Big shoutout to Megapieman for being such a good sport and allowing me (a complete noob) to work on such an important piece of his map! We are both very happy with the end result.</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Automate All The Things!</title>
        <author>
            <name>Patrick Hennessy</name>
        </author>
        <link href="https://patcave.me/automate-all-the-things/"/>
        <id>https://patcave.me/automate-all-the-things/</id>
            <category term="Programming Stuff"/>
            <category term="Gaming"/>

        <updated>2022-01-28T13:15:41-07:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://patcave.me/media/posts/1/GettyImages-1175415560_459958_ao5trb.jpg" alt="" />
                    I have this hobby where I basically take things that I spend a lot of time with and use my coding skills to try to automate things as much as I can, particularly in the realm of the video games I play. I originally started&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <img src="https://patcave.me/media/posts/1/GettyImages-1175415560_459958_ao5trb.jpg" alt="" />
                <p>I have this hobby where I basically take things that I spend a lot of time with and use my coding skills to try to automate things as much as I can, particularly in the realm of the video games I play.</p>
<hr>
<h2>How did I start doing this?</h2>
<p>I originally started programming and doing computer stuff way back in 2009; the end of high school. I had played a lot of Diablo II at the time; and in that game, to be 'godly' you needed to get a lot of high tier items. Doing that was a <em>super </em>grind.<br><br>I had done a few things to try to "strike it rich". What I finally realized is that the botter's<br>had it right. Automate the boring stuff and focus on what you want to do. And that's what I did!<br><br>I downloaded the <a href="https://www.projectetal.com/forums/" target="_blank" rel="noopener noreferrer">D2NT </a>bot and started picking it apart. I didn't know anything about programming or software really. I watched a few tutorials on the basics of Javascript (the embedded language the bot used to control it's actions). I didn't really understand the impact of changes I made so I made a LOT of mistakes and was forced to learn how the rest of it worked. This is where I learned to debug code as well; since most of what was there was code I personally didn't write.<br><br>I did a bunch of mini projects with this botting software. One of them was a rush bot; that basically (100% automatically) went through all the quests in the game for a low level character; something that used to be very manual and time consuming. This meant I could offer it as a service and actually scale it out.</p>
<hr>
<h2>Everyone should be doing this!</h2>
<p>It feels sooo good when you complete a project like that and it makes it so you almost don't have to do anything. Not only that; but even with something small like that; I learned a TON about how computers worked. I feel very strongly that the best way to learn CS is to partake in small but not dumb projects; make it something you actually care about and can have something tangible that you use after you're done. Something you personally would actually want to use.</p>
<p>I have continued doing this ever since. So lets talk about my latest venture...</p>
<hr>
<h1 id="my-team-fortress-2-server-automation-project">Team Fortress 2 server automation project</h1>
<figure class="post__image"><img loading="lazy"  src="https://patcave.me/media/posts/1/tf2_solly.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/1/responsive/tf2_solly-xs.png 300w ,https://patcave.me/media/posts/1/responsive/tf2_solly-sm.png 480w ,https://patcave.me/media/posts/1/responsive/tf2_solly-md.png 768w ,https://patcave.me/media/posts/1/responsive/tf2_solly-lg.png 1024w ,https://patcave.me/media/posts/1/responsive/tf2_solly-xl.png 1360w ,https://patcave.me/media/posts/1/responsive/tf2_solly-2xl.png 1600w"  alt="" width="1024" height="512"></figure>
<p>Easily my favorite game of all time is <a href="http://www.teamfortress.com/">Team Fortress 2</a>, I love this game so much, I could probably write an entire book on what TF2 does right.</p>
<p>So I have all these computer skills now; and one of the awesome things about Valve is they allow you to run your own servers! Not only that but there is a deep history of people modding the source engine for various things. Infact Valve literally released an <a href="https://github.com/ValveSoftware/source-sdk-2013">SDK</a> that exposes a lot of power to modders.</p>
<p>There's no way I'm not using my computer skills to make all of this stuff awesome. Basically this project is solving the problem that; I want as close to a self service competitive TF2 server than I can get.</p>
<p>Just for some context; I play on multiple competitive teams, and servers are CONSTANT pain for teams. I tried the "cheap" hosting solutions that most people do; I was super unhappy with what I got.</p>
<hr>
<h3>What problems am I solving and how?</h3>
<p><strong>Problem</strong>: Getting a "configured" server from a hosting provider is expensive and clunky</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>Run servers in your own cloud!</li>
<li>Have all the custom maps and plugins needed preloaded on the server, no extra configuring required</li>
</ul>
<p> </p>
<p><strong>Problem</strong>: Running servers 24/7 is expensive and unnecessary</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>Make it easy for users to provision servers on an ad-hoc basis</li>
<li>We still want people to be able to have a server when they need it</li>
<li>Servers will shut themselves down when no longer in use.</li>
<li>Installing monitoring software to optimize hardware and actual usage</li>
</ul>
<p> </p>
<p><strong>Problem</strong>: Configuring servers is slow; even when automated</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>Do this once and be able to deploy a LOT of identically configured systems</li>
<li>Follow the idea of a baked image</li>
<li>Allow server to come up with a few dynamic details (passwords, hostname, etc)</li>
</ul>
<p> </p>
<p><strong>Problem</strong>: Sometimes multiple people want a server at the same time</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>The ability to ask for servers ad-hoc means that I can host many servers at once and it would still be cheaper than running a single server 24/7 so long as they don't run ALL the time</li>
<li>Allow users to self service. Give them a simple menu to set the map, config, and item whitelist</li>
</ul>
<p> </p>
<p><strong>Problem</strong>: Players like to understand their in-game performance</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>Record and upload player stats and game recordings to known sites (<a href="http://demos.tf/">Demos.tf</a> &amp; <a href="http://logs.tf/">Logs.tf</a>)</li>
<li>Some leagues also <em>require</em> recordings, so this makes it certain you will have a high quality copy of the match</li>
</ul>
<p> </p>
<p><strong>Problem</strong>: Servers get hacked or DDoS'd</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>Do basic sever hardening (no ssh access, lock down source process, use random passwords, etc)</li>
<li>Put it in a network that has a high degree of fault tolerance</li>
<li>Put up stateful firewalls to block script kiddies</li>
<li>Set up kernel flags to mitigate common DoS attacks</li>
<li>Monitoring system should alert when events like this happen</li>
<li>Be able to just make a new server so now the hacker has to find all that info again</li>
</ul>
<p> </p>
<p><strong>Problem</strong>: Writing web UI's is time consuming and requires users to go a website</p>
<p><strong>Solution</strong>:</p>
<ul>
<li>Integrate with chat services (Discord) or be where players congregate the most</li>
<li>Basically, bring the solution to where users already are</li>
</ul>
<hr>
<h3>Result</h3>
<p>What I have now is the ability to summon a fully configured Team Fortress 2 server that I don't even need to be around to allow games to happen on.</p>
<h4 id="ansible">Ansible</h4>
<p>Basically I'm creating bootable images that can be turned into VM's very quickly. This uses a tool I already know from working as a System Administrator; <a href="https://www.ansible.com/">Ansible</a>. Using this technique makes it so I can boot a virtual machine get a working TF2 in ~2 minutes; which is remarkably fast, plus most users are quite happy to wait if it means a well configured high performance server they can frag on. These servers are setup to gracefully shutdown when no one is using it anymore.</p>
<p><em>Source code</em>: <a href="https://github.com/scrims-tf/provisioners">scrims-tf/provisioners</a></p>
<p> </p>
<h4 id="discord-bot-integration">Discord Bot integration</h4>
<p>I go a step further to enabling my Discord bot to respond to requests for a server. Not only that but it will give the user very useful information about the server and how to use it. Putting the docs right in front of them. Of course I'm using my own <a href="https://github.com/ns-phennessy/Arcbot">Discord bot library</a> for this.</p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/1/gallery/serveme-2-md.png" data-size="768x384"><img loading="lazy" src="https://patcave.me/media/posts/1/gallery/serveme-2-md-thumbnail.png" alt="" width="720" height="360"></a></figure>
</div></div>
<p><em>Source code</em>: <a href="https://github.com/scrims-tf/discord-bot-plugins">scrims-tf/discord-bot-plugins</a></p>
<p> </p>
<h4 id="monitoring">Monitoring</h4>
<p>Not only <em>that</em>; but it also automatically sends data to my <a href="https://www.influxdata.com/time-series-platform/">monitoring stack</a></p>
<div class="gallery-wrapper"><div class="gallery"  data-is-empty="false" data-columns="1">
<figure class="gallery__item"><a href="https://patcave.me/media/posts/1/gallery/tf2mon-md.png" data-size="768x396"><img loading="lazy" src="https://patcave.me/media/posts/1/gallery/tf2mon-md-thumbnail.png" alt="" width="720" height="371"></a></figure>
</div></div>
<p>My monitoring stack will send me alerts (also in Discord) when..</p>
<ul>
<li>High player count</li>
<li>High network bandwidth</li>
<li>High CPU / RAM usage</li>
<li>Server is older than a threshold (why is it hanging??)</li>
</ul>
<p>I can now also pull data out of my monitoring to optimize cost or understand how my servers operate.</p>
<p>I also really should automate creating my monitoring...</p>
<p> </p>
<h4 id="supporting-infrastructure">Supporting Infrastructure</h4>
<p>Not only <em>that</em>; but I went even further as to automate the actual network the systems live in. This allowed me to work with a new tool <a href="http://terraform.io/">Terraform</a>. This means that I can make lots of changes to all of this very easily. Basically able to re-create all of this if I want (say if I want to use Google's free trial over and over).</p>
<p><em>Source code</em>: <a href="https://github.com/scrims-tf/infrastructure">scrims-tf/infrastructure</a></p>
<p>I decided to put this on Google's cloud network. Mostly because I wanted to get my hands on and see if my distaste for AWS was because Amazon sucks and is the grass greener on the other side. So far, I've had a very positive experience with GCP, though some features are lacking like VPC-enabled databases. A side effect I didn't expect is that putting it on Google's network has lowered user ping on average for the players of the server. This is because Google has highly optimized their networks to enter their backbone much closer to the player's location; avoid a lot of the suboptimal routing that ISP's do with <a href="https://en.wikipedia.org/wiki/Border_Gateway_Protocol">BGP</a>.</p>
<p> </p>
<h4 id="custom-server-mods">Custom Server Mods</h4>
<p>I've had to also write a handful of mods for the server to allow some of this to happen. I do have to say that I'm thoroughly impressed by the modding community. A group of volunteers have been able to embed a working Python3.6 interpreter into the Source Engine, <strong><em>AND</em></strong> it doesn't suffer from a lot of the slowness usually associated with interpreted languages.</p>
<p><em>Source code</em>: <a href="https://github.com/scrims-tf/sourcemod-plugins">scrims-tf/sourcemod-plugins</a> and <a href="https://github.com/scrims-tf/sourcepython-plugins">scrims-tf/sourcepython-plugins</a></p>
<hr>
<h1 id="future-plans">Future Plans</h1>
<p>Automate more things! I want to play with the idea of extending the player stats logging to include not only more information but way more advanced ability to view that information. Maybe even work with some of my data science friends to derive cool insights. Player progression over time and maybe even something like an <a href="https://dota2.gamepedia.com/Matchmaking_Rating">MMR</a> or try to guess their skill division.</p>
<p>I also want to play with the idea of having the <a href="https://developer.valvesoftware.com/wiki/SourceTV">SourceTV</a> camera directed by machine learning. How awesome would it be to have a computer know and show you where the big moments are. Basically can follow the action in the game so viewers can just sit back and watch as if a crew was doing all of it.</p>
<p>Add some feature to make the "pick up game" (pug) experience better. MMR for players to try to balance teams. Ability to just randomize teams. Ability to have a 2 captains pick players and assign them to teams.</p>
<p>Offer this as a cheap paid service for the Team Fortress community in general. Not sure how much I would charge per month; not looking to get rich or anything; but make my hosting costs into nothing.</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>What I learned from making a Discord bot framework</title>
        <author>
            <name>Patrick Hennessy</name>
        </author>
        <link href="https://patcave.me/what-i-learned-from-making-a-discord-bot-from-scratch/"/>
        <id>https://patcave.me/what-i-learned-from-making-a-discord-bot-from-scratch/</id>
            <category term="Programming Stuff"/>

        <updated>2022-01-28T13:11:51-07:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://patcave.me/media/posts/2/cover-1.png" alt="" />
                    Lately I've been reading and hearing a lot about Chat Ops. It's a practice started by Github which uses a chat service like Hipchat or Slack with a bot user to provide feedback and insights into their infrastructure. This is super cool because it allows for transparency in to what&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <img src="https://patcave.me/media/posts/2/cover-1.png" alt="" />
                <p dir="auto">Lately I've been reading and hearing a lot about <a href="https://www.pagerduty.com/blog/what-is-chatops/" rel="nofollow">Chat Ops</a>. It's a practice started by Github which uses a chat service like <em>Hipchat</em> or <em>Slack</em> with a bot user to provide feedback and insights into their infrastructure.</p>
<p dir="auto">This is super cool because it allows for transparency in to what you're doing at any given time. Very useful in a high stress situation, like a big production failure where multiple engineers are trying to fix it; they can easily coordinate their efforts and not have to tell everyone what they're doing right that second because everyone can see it.</p>
<p dir="auto"> </p>
<h2 dir="auto">Motivations</h2>
<p dir="auto">When I was younger, I played in the early days of <strong>Starcraft 1</strong> and <strong>Diablo II</strong>. To play online; you had an IRC like client called Battle.Net, and there were bots galore. Thanks to our collective knowledge; the clan I was in at the time, we became the top clan in Diablo. One of the services we ran was a trivia bot, which is half the reason people came to our channel. The other was the exp runs they could get from it.</p>
<p dir="auto">Ever since getting on these modern chat services, I wanted a bot that I built entirely on my own. So my initial idea was to build a trivia bot. It used webhooks; and I did everything synchronously with some simple HTTP-server library. It worked; but was far from an ideal implementation.</p>
<p dir="auto">But I did have an awesome name for it: <em><strong>Regis Philbot</strong></em>, after the infamous Who Want's to be a Millionaire host; so of course I wanted to make the bot as cool as the name.</p>
<p dir="auto"> </p>
<h2 dir="auto">The first iteration</h2>
<p dir="auto">While there were many bots already out there; I wanted the challenge of building it myself from scratch. I made the decision to use Python, which I was still sort of new to at the time (but so glad I did).</p>
<p dir="auto">My initial design was poor; not thought out at all. I guess I just wanted to see if I could even get it to work at all. I did get it working; but it was very buggy and unstable.</p>
<p dir="auto">I had started using <a href="http://discordapp.com/" rel="nofollow">Discord</a> chat / voice service for some of my gaming friends and I, and I wanted to get a bot in there to have fun with. So started rewriting the bot from scratch and began the process of reverse engineering the Discord API. (This was fairly easy since Discord is a web based client)</p>
<p dir="auto"> </p>
<h2 dir="auto">Super Object Oriented Python Master Race</h2>
<p dir="auto">I didn't have the whole design in my head when I started; but my goal was to create a simple to use API for plugins, so that you can write a plugin that does stuff. To facilitate this; I started with a <code>Core</code> object.</p>
<h3 dir="auto">Core</h3>
<p dir="auto">In <a href="https://en.wikipedia.org/wiki/Object-oriented_programming" rel="nofollow">object oriented programming</a> terms, the <code>Core</code> uses <em>composition</em>. So then the question is; what things should the core allow us to do?</p>
<p dir="auto">Heres what I came up with:</p>
<ul dir="auto">
<li>Connect / Disconnect to chat service</li>
<li>Manage the Bot config</li>
<li>Handle plugins</li>
<li>Broker events</li>
</ul>
<h3 dir="auto">Connector</h3>
<p dir="auto">The connector class is the bot's interface to the chat service; in this case, I was using <a href="https://discordapp.com/" rel="nofollow">Discord</a>.</p>
<p dir="auto">This class was a good opportunity to use an <strong><a href="https://en.wikipedia.org/wiki/Protocol_(object-oriented_programming)" rel="nofollow">interface</a></strong>. So then we ask; what does the bot need to be able to do with the chat service? What things are common operations among all modern chat services?</p>
<p dir="auto">I created a number of methods to abstract this:</p>
<div class="highlight highlight-source-python position-relative overflow-auto">
<pre><span class="pl-s1">connector</span>.<span class="pl-en">say</span>()                 <span class="pl-c"># Says something in a chat channel</span>
<span class="pl-s1">connector</span>.<span class="pl-en">reply</span>()               <span class="pl-c"># Replies to a user who invoked a command</span>
<span class="pl-s1">connector</span>.<span class="pl-en">whisper</span>()             <span class="pl-c"># Uses private messaging with the user</span>
<span class="pl-s1">connector</span>.<span class="pl-en">getUser</span>()             <span class="pl-c"># Get data about a specific user</span>
<span class="pl-s1">connector</span>.<span class="pl-en">getChannel</span>()          <span class="pl-c"># Get data about a particular channel</span>
<span class="pl-s1">connector</span>.<span class="pl-en">upload</span>()              <span class="pl-c"># Upload a file to the server</span></pre>
</div>
<p dir="auto">The tricky part was going to be how I could make the bot <em>recieve</em> messages as well. This ended up being a <a href="https://docs.python.org/3.5/library/threading.html" rel="nofollow">thread</a> that just listens on a <a href="https://docs.python.org/3.5/library/socket.html" rel="nofollow">socket</a> for new messages.</p>
<p dir="auto">It was at this point I started hitting a lot of problems with the socket; websocket; and requests libraries. It got really wonky trying to use <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security" rel="nofollow">SSL</a> in Python 2.7, so I was forced to upgrade to Python 3.</p>
<p dir="auto">So now this <em>""message consumer""</em> thread would need to actually produce messages in a way the bot can understand and notify the bot that it has received a message. The first iteration of the system was poor; and it was already showing performance issues since this one thread was literally doing all the bot logic. <strong>Bad bad bad</strong></p>
<h3 dir="auto">Going Multi threaded</h3>
<p dir="auto">I has read that you can get considerable performance gains by using <a href="https://en.wikipedia.org/wiki/Thread_pool" rel="nofollow">thread pooling</a>. I could get away with this since I don't have to ensure that the bot does things in a 100% FIFO manner. I also thought that; what if a plugin is waiting on an HTTP response from an API? In a single threaded system; he would just be sitting there and no one could interact with it until that request returned. A bot isn't a <a href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop" rel="nofollow">REPL</a> interface per-say.</p>
<p dir="auto">So now I had to make a class to handle my pool of threads; and I had <em>never</em> done any meaningful threaded programming before this.</p>
<p dir="auto">Python makes this stupidly simple, it has a FIFO queue library that blocks when dequeueing an item. This just means that more than one thread can't take something from the queue at the same time as another. So then it was just as simple as creating a generic <code>worker</code> class that would run any function you give it. Python even makes this easy because functions are <a href="https://en.wikipedia.org/wiki/First-class_function" rel="nofollow">first class citizens.</a></p>
<p dir="auto">Awesome! I just learned a lot about threading and how the OS handles blocking; plus now my bot can be working on many things at once.</p>
<h3 dir="auto">Plugin System</h3>
<p dir="auto">This is where things got super <em>""meta""</em>.</p>
<p dir="auto">I wanted to be able to 'sandbox' plugins from each other; and be able to unload them. Once again, Python allows you do some cool things like dynamically linking code modules at runtime.</p>
<p dir="auto">I needed a way to manage these plugins. This led to me making a bunch of classes.</p>
<ul dir="auto">
<li>Plugin Superclass</li>
<li>Plugin Manager</li>
<li>Command Manager</li>
<li>Event Manager</li>
<li>Decorators (Oh god no)</li>
</ul>
<p dir="auto">So obviously; the Plugin manager is what handles the plugins themselves; Loading, unloading, and tracking their loaded instances.</p>
<p dir="auto">Python has this thing called <em>metaprogramming</em>; which allows you to mess with parts of methods and classes. Under the hood; everything is just a <code>dict</code> object. You can abuse this by piggy backing on it to pass information around.</p>
<p dir="auto">This is when I wrote my first decorator. What it does it set flags on a method to say that it is a command; and here is how it is invoked. I could now abstract this from the plugin so the manager could know that this is intended to be a command.</p>
<p dir="auto">Theres a problem that happens tho; if you hit an exception in a plugin; that threaded worker is now dead. Shit.</p>
<p dir="auto">So I had to make it so the workers would throw the exception but keep going.</p>
<p dir="auto"> </p>
<h2 dir="auto">Tying everything together</h2>
<p dir="auto">The glue that makes the bot work really lies in the <code>message consumer</code> thread; which resides in the connector. When it encounters a message from the socket; it queue's up for a threaded worker to pick up, and this worker will check to see if this message is something the bot should respond to.</p>
<h3 dir="auto">Gravy features</h3>
<p dir="auto">Getting the core functionality done felt pretty good. The plugin syntax was simple and everything worked very well together; but I felt very limited in what my plugin could do.</p>
<h4 dir="auto">Persistance</h4>
<p dir="auto">This was a tough one; I figured I wanted to use an <a href="https://en.wikipedia.org/wiki/Object-relational_mapping" rel="nofollow">ORM</a>, which basically allows you to use SQL as if it were Python code.</p>
<p dir="auto">The elephant in the room is <a href="http://www.sqlalchemy.org/" rel="nofollow">SQL Alchemy</a>, being that it is the most popular standalone ORM for Python. When I investigated it; I found it very clunky and really didn't like it. I considered a few other options until stumbling on <a href="http://docs.peewee-orm.com/en/latest/" rel="nofollow">PeeWee</a>; which is an extremely lightweight ORM. It had everything I needed without all the fluff.</p>
<p dir="auto">I abstracted it out a bit; plugins getting their own database file; as well as automatically setting up the database tables and a key value store for them behind the scenes. The less plugin code I have to write; the better.</p>
<h4 dir="auto">Access Control</h4>
<p dir="auto">This depended on persistence obviously; but I quickly found it tedious to have people being able to run any command on my bot. There was no way to restrict who could do what.</p>
<p dir="auto">I setup ACL's so that each user gets an 'access' rank, -1 to 999. You then specify in your plugins how much access is required to use a particular command. So now I have a <code>banhammer</code> command; which only I can use.</p>
<p dir="auto"> </p>
<h2 dir="auto">Challenges</h2>
<p dir="auto">There were a lot of gotchas that I fell into; and looks like a lot of Python programmers fall victim to them as well.</p>
<p dir="auto">I had to do some digging; but it turns out that Python's <code>thread</code> library is deprecated, and you're supposed to use the <code>threading</code> library instead. Super confusing.</p>
<p dir="auto">I had the same problem with the websocket library too though; there is a socket library, and several unofficial websocket libraries. The ones I looked at couldn't connect to my Slack server, and they were really clunky to use; but I found someone who was making something similar use a obscure websocket library which works extremely well. (Thank god)</p>
<p dir="auto"> </p>
<h2 dir="auto">What I learned</h2>
<p dir="auto">Overall; it has been a good experience. It caused me to touch many many aspects of Python; and get experience with using all these features together.</p>
<p dir="auto">The thread pool class had me dig into Python's <code>threading</code> library. I learned about the best practices for starting, managing and stopping threads; as well as design considerations.</p>
<p dir="auto">The other classes were more for organization and sanity; but I learned about <a href="http://www.secnetix.de/olli/Python/list_comprehensions.hawk" rel="nofollow">list comprehension</a> as well as iterators and iterables. Though I prefer using more explicit code for doing list operations.</p>
<p dir="auto">I also found out that there is official support for Java-like class declarations. You can create an abstract class, define getters and setters, method overloading, calling the super constructor, etc. Though in Python, it looks very odd in my opinion.</p>
<p dir="auto">My pub/sub system for events allowed me to learn about how functions/methods are treated on the same level as an <code>int</code>, and that there is a buttload of meta classes attached to each function callback, which can tell me things about it. I also played with decorators quite a bit. An interesting little syntactic sugar for Python; I thought it could simplify my plugin system even further, however I couldn't quite figure out how to make it work how I wanted it.</p>
<p dir="auto">When implementing my <code>help</code> command in my basic chat plugin; I learned about the <code>__docstring__</code> meta tag, so I could have my code documented in line. Fantastic.</p>
<p dir="auto"> </p>
<h2 dir="auto">In Summation...</h2>
<p dir="auto">For anyone who doesn't do random hacking projects like this; I highly recommend it. I touched quite a bit of Python's breadth and learned a hell of a lot about how everything works in the language.</p>
<p dir="auto">Most of all, the bot works! Sure, it's not perfect, there are some tweaks that it still needs; like more error handling, edge-case things, etc. But at this point; I would consider it stable enough to run it on my Discord server.","</p>
<p dir="auto">Lately I've been reading and hearing a lot about Chat Ops. It's essentially a DevOp's practice started by <strong>Github</strong> which uses a chat service like <em>Hipchat</em> or <em>Slack</em> with a bot user to manage their team and infrastructure.</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Graduation!</title>
        <author>
            <name>Patrick Hennessy</name>
        </author>
        <link href="https://patcave.me/graduation/"/>
        <id>https://patcave.me/graduation/</id>
            <category term="Personal"/>

        <updated>2022-04-26T05:11:18-06:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://patcave.me/media/posts/6/Columns_Jesse-10.jpg" alt="" />
                    Today is the day I graduate from college! I think there is no better time to reflect on my college journey. Back when I graduated high school, I didn't know what I wanted to do; or where I wanted to go. I felt rather lost;&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <img src="https://patcave.me/media/posts/6/Columns_Jesse-10.jpg" alt="" />
                <p>Today is the day I graduate from college! I think there is no better time to reflect on my college journey.</p>
<p><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">Back when I graduated high school, I didn't know what I wanted to do; or where I wanted to go. I felt rather lost; and it seemed like everyone else had a solid plan.</span></p>
<div>
<div> </div>
<div>How was everyone else so sure? Everyone talked about their future plans with such certainty. It blew my mind because; I knew myself that there is no way I could ever be that certain. It turns out that mostly everyone ended up changing their minds and going down as many different paths as me.</div>
<br>
<div>I figured it would just come to me after exposing myself to different things at a college, so I started up college immediately after high school.</div>
<div> </div>
<div><hr></div>
<div>
<h2>Freshman year at UCM</h2>
<div>I spent my freshman year at the <a href="https://www.ucmo.edu/">University of Central Missouri</a>.</div>
<div> <figure class="post__image post__image--right"><img loading="lazy"  src="https://patcave.me/media/posts/6//Central_Missouri_Athletics_logo.svg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/6//responsive/Central_Missouri_Athletics_logo.svg-xs.png 300w ,https://patcave.me/media/posts/6//responsive/Central_Missouri_Athletics_logo.svg-sm.png 480w ,https://patcave.me/media/posts/6//responsive/Central_Missouri_Athletics_logo.svg-md.png 768w ,https://patcave.me/media/posts/6//responsive/Central_Missouri_Athletics_logo.svg-lg.png 1024w ,https://patcave.me/media/posts/6//responsive/Central_Missouri_Athletics_logo.svg-xl.png 1360w ,https://patcave.me/media/posts/6//responsive/Central_Missouri_Athletics_logo.svg-2xl.png 1600w"  alt="" width="311" height="223"></figure></div>
<div>I'll be honest, I hated it there. I wanted to go to college to learn something but my peers were way more about the drinking and partying. The majority of my professors couldn't care less about students. There were so many reasons I felt like I didn't belong; and I questioned if college was for me.</div>
<br>
<div>I walked away from UCM with hardly anything of value. There wasn't anything really ground-breaking I learned there, it basically felt like a re-hash of high school.</div>
<br>
<div>I did marching band there because I had enjoyed it in high school, but it really was just unnecessary stress and I did not enjoy it at all.</div>
<div> </div>
<div>I was running a lot too; I had grown to love running in high school with cross country. It became a way for my to relieve stress and have a time away from everyone. Being an introverted freshmen living in the dorms can be a difficult, so I basically spent my large amount of free time that year either gaming or running. My classes were so easy that I didn't need to study very much if at all.</div>
<br>
<div>I thought that if this is all that college is, then why am I even going? I made the decision to drop out until I could figure things out for myself.</div>
<div> </div>
<div><hr></div>
<div>
<h2>Life as a dropout</h2>
<div>
<div>Of course, everyone in my life was judging me for leaving college, but I didn't care. I dropped out for good reasons. It was a nice break; and to this day I'm very glad I did it.</div>
<br>
<div>I worked a few jobs during this break. I worked as a deli clerk, at a doughnut shop, but probably my favorite gig I had was working as a waiter at weddings. I would only have to work once a week. The owners were super nice and made it a lot of fun. I got to see a lot of weddings and drunken toasts. The best part was we got to eat as much of the left overs that we could manage.</div>
<br>
<div>I took some online classes in nutrition during this break, something I've always been interested in, and something I wanted some more formal understanding of. There was a point that I thought I would become a nutritionist, or dietitian. After about eight months; I began to realize that almost everything I was learning was really subjective and that there are few things about the field that are concrete. I didn't feel like I knew anything because everything I was learning had lots of other sources that contradicted it. It's so hard to know what to believe in that field. I concluded that we just don't really know how to eat well or be healthy. We have some vague idea but that is not concrete enough for me; certainly not enough to build a career around.</div>
<br>
<div>I decided around May of that year that I wanted to go back to school but I was too late to apply by that time, so I just tabled the decision. In the meantime I was still working and doing my thing.</div>
<br>
<div>On my 21st birthday, my girlfriend at the time broke up with me because she thought I was a loser and thought frat guys were way cool. I find out later she slept with some random dude not even a week after she left for college, before we even broke up. I did not see that coming at all; at that time, we had been dating for about a year and everything was great so far as I knew. A few days later, I got fired from the deli because of something I didn't even do; and on top of that I had an extremely painful and debilitating medical condition arise. And because I got fired, my mom was on the verge of kicking me out of the house for "being too lazy". It all came out of nowhere and I was definitely not ready for it.</div>
<div> </div>
<div>At this point in my life; I really didn't think very highly of myself and saying I was depressed is an understatement; I probably had the worst 21st birthday you could have. When I took stock of my life; I realized that I didn't have a support network. My family has never been supportive in any way and my "friends" all vanished when I needed them most. It became abundantly clear to me that what I was doing was not working and that if things were going to get better it was going to be a result of me taking action.</div>
<br>
<div>As depressed as I was, all this actually made me want to go back to school even more. I had heard a lot of good things about Mizzou from various people; so I figured it was a solid choice. It was close to home, a big school with a lot of social life things to do and it sounded like it would be a lot of fun. It would be a way I could get away from all the bullshit. I needed to change and this was a huge step towards doing so. I applied to Mizzou that fall and got accepted at the beginning of December.</div>
<br>
<div>On the upside of all this, with the free time I had; I really got into programming. I had been a gamer for a long time; and I was playing a lot of Diablo 2 at the time. I learned programming almost out of necessity because I wanted to have a Diablo 2 bot do cool things and improve it's behavior. I reverse engineered the bot API and taught myself JavaScript in about a week. I wrote a lot of really fun scripts that allowed our Guild to become the top on BattleNet; and I very quickly became an expert on how to use the bot. It was a great project to work on to get my hands dirty with software.</div>
<div> </div>
<div><hr></div>
</div>
<div>
<h2>Starting at Mizzou</h2>
<figure class="post__image post__image--left"><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);"><img loading="lazy"  src="https://patcave.me/media/posts/6//1200px-Missouri_Tigers_logo.svg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/6//responsive/1200px-Missouri_Tigers_logo.svg-xs.png 300w ,https://patcave.me/media/posts/6//responsive/1200px-Missouri_Tigers_logo.svg-sm.png 480w ,https://patcave.me/media/posts/6//responsive/1200px-Missouri_Tigers_logo.svg-md.png 768w ,https://patcave.me/media/posts/6//responsive/1200px-Missouri_Tigers_logo.svg-lg.png 1024w ,https://patcave.me/media/posts/6//responsive/1200px-Missouri_Tigers_logo.svg-xl.png 1360w ,https://patcave.me/media/posts/6//responsive/1200px-Missouri_Tigers_logo.svg-2xl.png 1600w"  alt="" width="318" height="181"></figure>I started school again in that January. </span><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">Mizzou requires transfer students to declare a major and again I was like how am I going to be sure? I figured that since I was able to teach myself programming, I would have a taste of that major for a while; I planned to revisit the idea down the road after a few classes. </span></p>
<p><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">I declared myself a computer science major; and honestly, my initial motivation for being CS had nothing to do with career prospects or money or anything like that. It was just so I could enhance my gaming life like I had done before. There was a lot of cool hacks that I had seen or used, but didn't have the knowledge to know how they worked and I really wanted to know how that all worked.</span></p>
<div><br>
<div>The first 2 classes I took; we didn't really learn a lot of new groundbreaking ideas for me; and I craved more knowledge, so I started learning things outside of class just for fun. I fully embraced my own curiosity and ability to teach myself. I learned a great deal of self efficacy from that. I kept writing new scripts for my bot; but also got into the web stack. I learned some HTML and CSS and played with that a lot. I also started learning about networking so I could come up with a way to prevent the IP blacklisting that happened when Blizzard thought you were botting.</div>
<br>
<div>I also got into the social life at Mizzou quite a bit. Being 21, I could go out to the bars and there was always something to do; though I still really didn't feel like I fit in there. A lot of the times I was out 'partying' I really just wished I was home doing one of my nerdy hobbies.</div>
<div> </div>
<div><hr></div>
</div>
</div>
<h2>Computer Science major</h2>
<div>
<div>There was a distinct point when everything just suddenly made sense for me; and I really understood how computer systems work.</div>
<div> </div>
<div>I took a class called "Unix OS", where we learned how the Unix file system works and how to use basic commands as well as how the operating system works on a deeper level. After about a month in that class, light bulbs turning on for me everywhere, I installed Linux on my laptop and used that for the rest of college. Living in a Linux environment; and all the information about it on the internet, allowed me to understand every little bit about the operating system that I could. A lot of the things about Linux are applicable to all systems.</div>
<br>
<div>It was at this point I was absolutely sure I wouldn't be changing my major again; it felt right. I was much more confident in myself and my abilities. That, and I started looking at my career prospects as a CS major and was dumbfounded by how in-demand software engineers are and how much they get paid.</div>
<br>
<div>One of the things about that class I really loved was how our professor would rather you be a self-learner, and didn't really grade harshly for not following an arbitrary set of rules. The class was more focused on fostering the students desire to explore. We would have an assignment; but it was for completion; and if you could demonstrate that you learned something you didn't know before. I had a few more classes like that, and looking back at it; those are the areas in my major that I'm strongest at. Big shout out to Matt Dickenson, defiantly my favorite professor at Mizzou.</div>
<div> </div>
<div><hr></div>
<h2>ACM &amp; Cyber Security SIG</h2>
<div>
<div>From the get-go at Mizzou, I got involved with the ACM. I attended the meetings and went to a few workshops but was never as involved as I would've liked. I didn't know anyone and didn't know that such a thing as a SIG (special interest group). There was one semester that they had elected new leadership and kickstarted a lot of new things.</div>
<br>
<div>Out of the handful of existing SIGs, I gravitated towards the cyber security one. Not many people stuck around after the first meeting, so myself and one of my classmates basically were now leading it. I had next to no knowledge of security prior to this so being it's "leader" felt very much like imposter syndrome. But we ended up doing a lot of really cool things and messed with things you would never see in class.</div>
<br>
<div>I think at one point we were the largest and most active SIG; which is pretty awesome. We taught each other stuff and discussed cyber security news and shared interesting tidbits of things we saw out in the wild or elsewhere. It was a lot of fun and I got to meet a lot of cool people in the process. It's also been very beneficial to other areas of my computing knowledge; since security is everywhere, and to be able to understand some of the sophisticated attacks; you are forced to know a lot about all of the individual parts.</div>
<br>
<div>ACM was a great organization to join. I got to meet so many cool people and it was a place that I fit in very well. We did all kinds of fun things and everyone was super helpful. They even hosted a hackathon which for me was like a party. A whole weekend of engineers tinkering with new and interesting things, junk food galore, all nighters; sign me up!</div>
<div> </div>
<div><hr></div>
<h2>Internship at Carfax</h2>
<figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/6/CarFax-Vehicle-History-Report.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/6/responsive/CarFax-Vehicle-History-Report-xs.png 300w ,https://patcave.me/media/posts/6/responsive/CarFax-Vehicle-History-Report-sm.png 480w ,https://patcave.me/media/posts/6/responsive/CarFax-Vehicle-History-Report-md.png 768w ,https://patcave.me/media/posts/6/responsive/CarFax-Vehicle-History-Report-lg.png 1024w ,https://patcave.me/media/posts/6/responsive/CarFax-Vehicle-History-Report-xl.png 1360w ,https://patcave.me/media/posts/6/responsive/CarFax-Vehicle-History-Report-2xl.png 1600w"  alt="" width="288" height="195"></figure>
<div>
<div>During my junior year, I went out applying for internships.</div>
<div> </div>
<div>I wasn't very confident in my ability to work in a "real" environment. My only non-trivial project was my Diablo bot; not really something a company would find valuable.</div>
<div> </div>
<div>The first time I went to the career fair was quite intimidating. I was afraid that I didn't know enough or that all the time I spent on learning random things was a wasted effort.</div>
<br>
<div>However, to my surprise, almost every recruiter was super nice and genuinely interested in what I had to say. I made myself a list of about 20 employers I wanted to talk to, all by priority of how much I wanted the job. I knew I'd probably stumble on my first few chats, so I picked a company low on my list first. After a handful of awkward conversations and just throwing things at the wall and seeing what sticks; I got the a good idea of what I need to do. So I went right in and talked to the one at the top of my list; Carfax.</div>
<br>
<div>It went great and turns out the recruiter also went to UCM. I remember walking away from that thinking that I totally nailed it. Sure enough; they brought me in for an interview. I stumbled a little bit through their programming part but I must've done something right because they ended up hiring me for the internship that summer.</div>
<br>
<div>I wanted to use this internship as an opportunity to get as much knowledge as I could. Working directly on production code with folks who are much better and more experienced than yourself is an excellent way to learn. I would ask so many questions to try to absorb as much as I could. As far an internships go, it was exactly what I wanted. It was close to my house in Columbia, it was within my skill set, and the work environment is very laid back and fun and I got paid pretty handsomely. It wasn't uncommon to play a game of mario kart in the middle of the day against co-workers.</div>
<br>
<div>At the end of that summer; I was asked if I wanted to stay on part time during my next semester. Hell yes! This was awesome, I could pick up a few extra bucks, and get some more experience.</div>
<br>
<div>As it turns out however; that it was a lot to handle; I was working around 25 hours / week, I had a full class load, I was running the cyber security SIG, I was partaking in the college nightlife, and trying to have a relationship. It got out of hand how little free time I had. It was not unusual for me to get about 3-4 hours of sleep per night. Defiantly the busiest semester of my life, and I really didn't like it because there were so many things I wanted to work on or play with but just simply didn't have the time.</div>
<div> </div>
<div><hr></div>
</div>
</div>
<h2>Finally, Graduation!</h2>
<div>
<div><figure class="post__image post__image--left"><img loading="lazy"  src="https://patcave.me/media/posts/6/Why-Do-We-Throw-Graduation-Caps.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/6/responsive/Why-Do-We-Throw-Graduation-Caps-xs.png 300w ,https://patcave.me/media/posts/6/responsive/Why-Do-We-Throw-Graduation-Caps-sm.png 480w ,https://patcave.me/media/posts/6/responsive/Why-Do-We-Throw-Graduation-Caps-md.png 768w ,https://patcave.me/media/posts/6/responsive/Why-Do-We-Throw-Graduation-Caps-lg.png 1024w ,https://patcave.me/media/posts/6/responsive/Why-Do-We-Throw-Graduation-Caps-xl.png 1360w ,https://patcave.me/media/posts/6/responsive/Why-Do-We-Throw-Graduation-Caps-2xl.png 1600w"  alt="" width="1200" height="628"></figure>I think that looking back; while I might have spent and extra 2 years to get my degree, it was well worth it. I never would have thought in high school that I would be where I am now; that's for sure.</div>
</div>
<div><br>
<div> </div>
<div>Of the many things I've learned, the most important things I learned from my time since high school was that I should just embrace who I am. There were many times I put too much pressure on myself to make a choice; or times where I didn't think too highly of myself because I let others influence me way more than I should've.</div>
<div> </div>
<div>I found something that I really enjoy learning about and doing. I proved to myself that I am capable of shaping my own reality and affecting positive change into my life.</div>
</div>
</div>
<div> </div>
</div>
</div>
</div>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Setting up a secure Linux Server</title>
        <author>
            <name>Patrick Hennessy</name>
        </author>
        <link href="https://patcave.me/setting-up-a-secure-linux-server/"/>
        <id>https://patcave.me/setting-up-a-secure-linux-server/</id>
            <category term="Programming Stuff"/>

        <updated>2022-01-29T15:34:40-07:00</updated>
            <summary>
                <![CDATA[
                        <img src="https://patcave.me/media/posts/4/linux.security.11614.jpg" alt="" />
                    This is not a comprehensive guide; but should get you started and prevent you from getting pwned immediately. Following these small steps will make you a much harder target to compromise, and are probably not worth most hackers time. There are a lot of automated&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                    <img src="https://patcave.me/media/posts/4/linux.security.11614.jpg" alt="" />
                <p dir="auto">This is not a comprehensive guide; but should get you started and prevent you from getting pwned immediately.</p>
<p dir="auto">Following these small steps will make you a much harder target to compromise, and are probably not worth most hackers time.</p>
<p dir="auto">There are a lot of automated attacks going around and hitting known server cluster IP ranges looking for low hanging fruit and vulnerable servers they can exploit.</p>
<hr>
<h2 dir="auto">Creating a Droplet</h2>
<p dir="auto">DigitalOcean makes it very simple to create a droplet. Once you have an account, create a droplet</p>
<ul dir="auto">
<li><strong>Name</strong>: Name your droplet whatever you want. This will become the <strong>hostname</strong> on the machine itself once it's created.</li>
<li><strong>Size</strong>: Go for the cheapest one. The most it will charge you is $5 / month (a very good deal imo).</li>
<li><strong>Location</strong>: I've found that the New York location is rather slow for me, so I usually opt for the San Francisco location.</li>
<li><strong>Image</strong>: Most people will be comfortable with Ubuntu; so we will select that.</li>
</ul>
<p dir="auto">Also important to note; you should opt for using <a href="https://wiki.ubuntu.com/LTS" rel="nofollow">LTS</a> releases since they're supported for a while.</p>
<hr>
<h2 dir="auto">Login</h2>
<p dir="auto">Once created; DigitalOcean will e-mail you your new login credentials.</p>
<h3 dir="auto">From a Terminal (OSX or Linux)</h3>
<p dir="auto">Open a terminal window and type in the following command:</p>
<div class="highlight highlight-source-shell position-relative overflow-auto">
<pre>ssh root@ipaddress</pre>
</div>
<p dir="auto">It will prompt for a password; enter the one sent to your email.</p>
<h3 dir="auto">From Putty (Windows)</h3>
<p dir="auto">Download <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html" rel="nofollow">PuTTy</a> if you don't have it already. PuTTy will simulate a terminal session similar to that on a Linux or OSX system.</p>
<p dir="auto">Put in the supplied ip-address in the <code>hostname</code> field, and leave the port on <code>22</code>. Then click connect.</p>
<p dir="auto">You will be prompted for your password; feel free to copy and paste it from the email directly. If you did everything right; you should now be logged into your DigitalOcean node as the root user!</p>
<hr>
<h2 dir="auto">Installing Updates</h2>
<p dir="auto">The first thing you should do is bring all your software up to date.</p>
<p dir="auto">DigitalOcean does pretty well keeping their images up to date; but you want to get in the habit of having the freshest updates to software on your system.</p>
<p dir="auto">Use the following commands:</p>
<div class="highlight highlight-source-shell position-relative overflow-auto">
<pre>apt-get update
apt-get upgrade</pre>
</div>
<p dir="auto"><strong>update</strong> will hit all the <a href="https://help.ubuntu.com/community/Repositories/Ubuntu" rel="nofollow">Ubuntu repositories</a> and refresh any package names or versions.</p>
<p dir="auto"><strong>upgrade</strong> will upgrade any out of date packages and remove anything that is now unnecessary on your system.</p>
<hr>
<h2 dir="auto">Disabling Root Access</h2>
<p dir="auto">It's a good idea to disable root user logins via SSH. Root is allowed to do literally anything on a system, so it's a dangerous account.</p>
<hr>
<h2 dir="auto">Add an admin (sudo) account</h2>
<p dir="auto">A <strong>sudo</strong> user is a user on a Linux system who as the ability to perform certain root-level operations after a password prompt. <em>You should only give <code>sudo</code> access to users who absolutely need it.</em></p>
<p dir="auto">Use the following command to add a new sudoer:</p>
<div class="highlight highlight-source-shell position-relative overflow-auto">
<pre>useradd -g sudo -s /bin/bash pat</pre>
</div>
<p dir="auto">It will prompt you for a password and email; put whatever you like there (it can be changed later if desired).</p>
<p dir="auto">Once done; I would <em><strong>highly</strong></em> recommend starting another terminal or PuTTy session and logging in as this user to verify that you're able to login. The last thing you want is to lock yourself out.</p>
<h3 dir="auto">Disable Root Login over SSH</h3>
<p dir="auto">Next you'll need to stop the root user from logging in at all.</p>
<div class="highlight highlight-source-shell position-relative overflow-auto">
<pre>vim /etc/ssh/sshd_config</pre>
</div>
<p dir="auto">Look for a line that says <code>PermitRootLogin</code> and set it to <code>no</code></p>
<p dir="auto">Then reset the SSH server:</p>
<div class="highlight highlight-source-shell position-relative overflow-auto">
<pre>systemctl restart sshd</pre>
</div>
<hr>
<h2 dir="auto">Firewall</h2>
<p dir="auto">Another important thing to do is to stop automated port scanning attacks on your server. At the moment, we are only using a single port for our communications, <em>22</em> for SSH. A <a href="http://en.wikipedia.org/wiki/Firewall_%28computing%29" rel="nofollow">firewall</a> can stop other hosts from connecting to those ports, hogging up system resources, and potentially exploiting unknown vulnerabilities.</p>
<p dir="auto">You should tune the rules to your liking, but heres a good <a href="https://gist.github.com/ns-phennessy/5a3b60e41022748f5f68">boilerplate</a> to start from</p>
<div class="highlight highlight-source-shell position-relative overflow-auto">
<pre>wget https://gist.githubusercontent.com/ns-phennessy/5a3b60e41022748f5f68/raw/e9e96a793dd5668b8568a437e083594318a41c86/Firewall%20Script
chmod +x Firewall<span class="pl-cce">\ </span>Script
sudo bash Firewall<span class="pl-cce">\ </span>Script</pre>
</div>
<p dir="auto">The script will setup sensible defaults and leave port 22 open. <strong>IT IS VERY IMPORTANT TO NEVER CLOSE PORT 22</strong>. You <em>will</em> lock yourself out of your system if you do this.</p>
<hr>
<h2 dir="auto">Fail2Ban</h2>
<p dir="auto"><a href="http://en.wikipedia.org/wiki/Fail2ban" rel="nofollow">Fail2Ban</a> is a <a href="http://en.wikipedia.org/wiki/Daemon_%28computing%29" rel="nofollow">daemon</a> that follows the authentication log and see if any IP address has too many failed login attempts, and temporarily bans them.</p>
<p dir="auto">Install it and setup default config:</p>
<div class="highlight highlight-source-shell position-relative overflow-auto">
<pre>sudo apt-get install fail2ban
sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local</pre>
</div>
<p dir="auto">You can now go and tweak your jail settings.</p>
<div class="highlight highlight-source-shell position-relative overflow-auto">
<pre>sudo vim /etc/fail2ban/jail.local</pre>
</div>
<p dir="auto">I like to set my <code>bantime</code> ridiculously high but give myself a <code>maxretry</code> of at least 5 over a <code>findtime</code> of about 10 minutes.</p>
<p dir="auto">Remember that the goal is to catch brute force attacks, you need to be aware that your rules will have to reflect the kind of traffic you're seeing. A smart attacker will brute force your system slowly to avoid getting caught up in filters like this one.</p>
<hr>
<h2 dir="auto">Done!</h2>
<p dir="auto">Congrats, you're setup and had your first taste with server security. Hopefully this article has given you some insight into how to setup and maintain a Linux server and not get immediately hacked</p>
            ]]>
        </content>
    </entry>
</feed>
