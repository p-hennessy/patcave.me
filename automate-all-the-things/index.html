<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Automate All The Things! - The Patcave</title><meta name="description" content="I have this hobby where I basically take things that I spend a lot of time with and use my coding skills to try to automate things as much as I can, particularly in the realm of the video games I play. I originally started&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://patcave.me/automate-all-the-things/"><link rel="amphtml" href="https://patcave.me/amp/automate-all-the-things/"><link rel="alternate" type="application/atom+xml" href="https://patcave.me/feed.xml"><link rel="alternate" type="application/json" href="https://patcave.me/feed.json"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700&amp;subset=latin-ext&amp;display=swap" rel="stylesheet"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:'Roboto Condensed',sans-serif;--logo-font:'Roboto Condensed',sans-serif;--menu-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://patcave.me/assets/css/style.css?v=4945aedf837c971c57d7192803b442c1"><link rel="stylesheet" href="https://patcave.me/assets/css/photoswipe.css?v=7331f6eb15671b2fc8e3ffd46e849f7b"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://patcave.me/automate-all-the-things/"},"headline":"Automate All The Things!","datePublished":"2018-09-15T14:00","dateModified":"2022-01-28T13:15","image":{"@type":"ImageObject","url":"https://patcave.me/media/posts/1/GettyImages-1175415560_459958_ao5trb.jpg","height":1080,"width":1920},"description":"I have this hobby where I basically take things that I spend a lot of time with and use my coding skills to try to automate things as much as I can, particularly in the realm of the video games I play. I originally started&hellip;","author":{"@type":"Person","name":"Patrick Hennessy"},"publisher":{"@type":"Organization","name":"Patrick Hennessy"}}</script><style>.pswp--svg .pswp__button,
				          .pswp--svg .pswp__button--arrow--left:before,
				          .pswp--svg .pswp__button--arrow--right:before {
					          background-image: url(https://patcave.me/assets/svg/gallery-icons-light.svg);
			              }</style><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Boogaloo&family=Maven+Pro&display=swap" rel="stylesheet"></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://patcave.me/">The Patcave</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://patcave.me/" target="_self">Home</a></li><li><a href="https://patcave.me/about/" target="_self">About</a></li><li class="has-submenu"><span class="is-separator" aria-haspopup="true">Contact</span><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://www.linkedin.com/in/pmhennessy/" target="_blank">LinkedIn</a></li><li><a href="https://github.com/ns-phennessy" target="_blank">Github</a></li><li><a href="https://www.youtube.com/channel/UCIw-YA385k1S5IOwYD-iV5Q" target="_blank">YouTube</a></li><li><a href="https://tf2maps.net/members/zeus.28272/" target="_blank">TF2Maps.net</a></li><li><a href="mailto:phennessy517@gmail.com" target="_blank">Email</a></li></ul></li></ul></nav></header><main><article class="post"><div class="hero"><figure class="hero__image hero__image--overlay"><img src="https://patcave.me/media/posts/1/GettyImages-1175415560_459958_ao5trb.jpg" srcset="https://patcave.me/media/posts/1/responsive/GettyImages-1175415560_459958_ao5trb-xs.jpg 300w, https://patcave.me/media/posts/1/responsive/GettyImages-1175415560_459958_ao5trb-sm.jpg 480w, https://patcave.me/media/posts/1/responsive/GettyImages-1175415560_459958_ao5trb-md.jpg 768w, https://patcave.me/media/posts/1/responsive/GettyImages-1175415560_459958_ao5trb-lg.jpg 1024w, https://patcave.me/media/posts/1/responsive/GettyImages-1175415560_459958_ao5trb-xl.jpg 1360w, https://patcave.me/media/posts/1/responsive/GettyImages-1175415560_459958_ao5trb-2xl.jpg 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="1080" width="1920" alt=""></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2018-09-15T14:00">September 15, 2018</time></div><h1>Automate All The Things!</h1></div></header></div><div class="wrapper post__entry"><p>I have this hobby where I basically take things that I spend a lot of time with and use my coding skills to try to automate things as much as I can, particularly in the realm of the video games I play.</p><hr><h2>How did I start doing this?</h2><p>I originally started programming and doing computer stuff way back in 2009; the end of high school. I had played a lot of Diablo II at the time; and in that game, to be 'godly' you needed to get a lot of high tier items. Doing that was a <em>super </em>grind.<br><br>I had done a few things to try to "strike it rich". What I finally realized is that the botter's<br>had it right. Automate the boring stuff and focus on what you want to do. And that's what I did!<br><br>I downloaded the <a href="https://www.projectetal.com/forums/" target="_blank" rel="noopener noreferrer">D2NT </a>bot and started picking it apart. I didn't know anything about programming or software really. I watched a few tutorials on the basics of Javascript (the embedded language the bot used to control it's actions). I didn't really understand the impact of changes I made so I made a LOT of mistakes and was forced to learn how the rest of it worked. This is where I learned to debug code as well; since most of what was there was code I personally didn't write.<br><br>I did a bunch of mini projects with this botting software. One of them was a rush bot; that basically (100% automatically) went through all the quests in the game for a low level character; something that used to be very manual and time consuming. This meant I could offer it as a service and actually scale it out.</p><hr><h2>Everyone should be doing this!</h2><p>It feels sooo good when you complete a project like that and it makes it so you almost don't have to do anything. Not only that; but even with something small like that; I learned a TON about how computers worked. I feel very strongly that the best way to learn CS is to partake in small but not dumb projects; make it something you actually care about and can have something tangible that you use after you're done. Something you personally would actually want to use.</p><p>I have continued doing this ever since. So lets talk about my latest venture...</p><hr><h1 id="my-team-fortress-2-server-automation-project">Team Fortress 2 server automation project</h1><figure class="post__image"><img loading="lazy" src="https://patcave.me/media/posts/1/tf2_solly.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://patcave.me/media/posts/1/responsive/tf2_solly-xs.png 300w, https://patcave.me/media/posts/1/responsive/tf2_solly-sm.png 480w, https://patcave.me/media/posts/1/responsive/tf2_solly-md.png 768w, https://patcave.me/media/posts/1/responsive/tf2_solly-lg.png 1024w, https://patcave.me/media/posts/1/responsive/tf2_solly-xl.png 1360w, https://patcave.me/media/posts/1/responsive/tf2_solly-2xl.png 1600w" alt="" width="1024" height="512"></figure><p>Easily my favorite game of all time is <a href="http://www.teamfortress.com/">Team Fortress 2</a>, I love this game so much, I could probably write an entire book on what TF2 does right.</p><p>So I have all these computer skills now; and one of the awesome things about Valve is they allow you to run your own servers! Not only that but there is a deep history of people modding the source engine for various things. Infact Valve literally released an <a href="https://github.com/ValveSoftware/source-sdk-2013">SDK</a> that exposes a lot of power to modders.</p><p>There's no way I'm not using my computer skills to make all of this stuff awesome. Basically this project is solving the problem that; I want as close to a self service competitive TF2 server than I can get.</p><p>Just for some context; I play on multiple competitive teams, and servers are CONSTANT pain for teams. I tried the "cheap" hosting solutions that most people do; I was super unhappy with what I got.</p><hr><h3>What problems am I solving and how?</h3><p><strong>Problem</strong>: Getting a "configured" server from a hosting provider is expensive and clunky</p><p><strong>Solution</strong>:</p><ul><li>Run servers in your own cloud!</li><li>Have all the custom maps and plugins needed preloaded on the server, no extra configuring required</li></ul><p> </p><p><strong>Problem</strong>: Running servers 24/7 is expensive and unnecessary</p><p><strong>Solution</strong>:</p><ul><li>Make it easy for users to provision servers on an ad-hoc basis</li><li>We still want people to be able to have a server when they need it</li><li>Servers will shut themselves down when no longer in use.</li><li>Installing monitoring software to optimize hardware and actual usage</li></ul><p> </p><p><strong>Problem</strong>: Configuring servers is slow; even when automated</p><p><strong>Solution</strong>:</p><ul><li>Do this once and be able to deploy a LOT of identically configured systems</li><li>Follow the idea of a baked image</li><li>Allow server to come up with a few dynamic details (passwords, hostname, etc)</li></ul><p> </p><p><strong>Problem</strong>: Sometimes multiple people want a server at the same time</p><p><strong>Solution</strong>:</p><ul><li>The ability to ask for servers ad-hoc means that I can host many servers at once and it would still be cheaper than running a single server 24/7 so long as they don't run ALL the time</li><li>Allow users to self service. Give them a simple menu to set the map, config, and item whitelist</li></ul><p> </p><p><strong>Problem</strong>: Players like to understand their in-game performance</p><p><strong>Solution</strong>:</p><ul><li>Record and upload player stats and game recordings to known sites (<a href="http://demos.tf/">Demos.tf</a> &amp; <a href="http://logs.tf/">Logs.tf</a>)</li><li>Some leagues also <em>require</em> recordings, so this makes it certain you will have a high quality copy of the match</li></ul><p> </p><p><strong>Problem</strong>: Servers get hacked or DDoS'd</p><p><strong>Solution</strong>:</p><ul><li>Do basic sever hardening (no ssh access, lock down source process, use random passwords, etc)</li><li>Put it in a network that has a high degree of fault tolerance</li><li>Put up stateful firewalls to block script kiddies</li><li>Set up kernel flags to mitigate common DoS attacks</li><li>Monitoring system should alert when events like this happen</li><li>Be able to just make a new server so now the hacker has to find all that info again</li></ul><p> </p><p><strong>Problem</strong>: Writing web UI's is time consuming and requires users to go a website</p><p><strong>Solution</strong>:</p><ul><li>Integrate with chat services (Discord) or be where players congregate the most</li><li>Basically, bring the solution to where users already are</li></ul><hr><h3>Result</h3><p>What I have now is the ability to summon a fully configured Team Fortress 2 server that I don't even need to be around to allow games to happen on.</p><h4 id="ansible">Ansible</h4><p>Basically I'm creating bootable images that can be turned into VM's very quickly. This uses a tool I already know from working as a System Administrator; <a href="https://www.ansible.com/">Ansible</a>. Using this technique makes it so I can boot a virtual machine get a working TF2 in ~2 minutes; which is remarkably fast, plus most users are quite happy to wait if it means a well configured high performance server they can frag on. These servers are setup to gracefully shutdown when no one is using it anymore.</p><p><em>Source code</em>: <a href="https://github.com/scrims-tf/provisioners">scrims-tf/provisioners</a></p><p> </p><h4 id="discord-bot-integration">Discord Bot integration</h4><p>I go a step further to enabling my Discord bot to respond to requests for a server. Not only that but it will give the user very useful information about the server and how to use it. Putting the docs right in front of them. Of course I'm using my own <a href="https://github.com/ns-phennessy/Arcbot">Discord bot library</a> for this.</p><div class="gallery-wrapper"><div class="gallery" data-is-empty="false" data-columns="1"><figure class="gallery__item"><a href="https://patcave.me/media/posts/1/gallery/serveme-2-md.png" data-size="768x384"><img loading="lazy" src="https://patcave.me/media/posts/1/gallery/serveme-2-md-thumbnail.png" alt="" width="720" height="360"></a></figure></div></div><p><em>Source code</em>: <a href="https://github.com/scrims-tf/discord-bot-plugins">scrims-tf/discord-bot-plugins</a></p><p> </p><h4 id="monitoring">Monitoring</h4><p>Not only <em>that</em>; but it also automatically sends data to my <a href="https://www.influxdata.com/time-series-platform/">monitoring stack</a></p><div class="gallery-wrapper"><div class="gallery" data-is-empty="false" data-columns="1"><figure class="gallery__item"><a href="https://patcave.me/media/posts/1/gallery/tf2mon-md.png" data-size="768x396"><img loading="lazy" src="https://patcave.me/media/posts/1/gallery/tf2mon-md-thumbnail.png" alt="" width="720" height="371"></a></figure></div></div><p>My monitoring stack will send me alerts (also in Discord) when..</p><ul><li>High player count</li><li>High network bandwidth</li><li>High CPU / RAM usage</li><li>Server is older than a threshold (why is it hanging??)</li></ul><p>I can now also pull data out of my monitoring to optimize cost or understand how my servers operate.</p><p>I also really should automate creating my monitoring...</p><p> </p><h4 id="supporting-infrastructure">Supporting Infrastructure</h4><p>Not only <em>that</em>; but I went even further as to automate the actual network the systems live in. This allowed me to work with a new tool <a href="http://terraform.io/">Terraform</a>. This means that I can make lots of changes to all of this very easily. Basically able to re-create all of this if I want (say if I want to use Google's free trial over and over).</p><p><em>Source code</em>: <a href="https://github.com/scrims-tf/infrastructure">scrims-tf/infrastructure</a></p><p>I decided to put this on Google's cloud network. Mostly because I wanted to get my hands on and see if my distaste for AWS was because Amazon sucks and is the grass greener on the other side. So far, I've had a very positive experience with GCP, though some features are lacking like VPC-enabled databases. A side effect I didn't expect is that putting it on Google's network has lowered user ping on average for the players of the server. This is because Google has highly optimized their networks to enter their backbone much closer to the player's location; avoid a lot of the suboptimal routing that ISP's do with <a href="https://en.wikipedia.org/wiki/Border_Gateway_Protocol">BGP</a>.</p><p> </p><h4 id="custom-server-mods">Custom Server Mods</h4><p>I've had to also write a handful of mods for the server to allow some of this to happen. I do have to say that I'm thoroughly impressed by the modding community. A group of volunteers have been able to embed a working Python3.6 interpreter into the Source Engine, <strong><em>AND</em></strong> it doesn't suffer from a lot of the slowness usually associated with interpreted languages.</p><p><em>Source code</em>: <a href="https://github.com/scrims-tf/sourcemod-plugins">scrims-tf/sourcemod-plugins</a> and <a href="https://github.com/scrims-tf/sourcepython-plugins">scrims-tf/sourcepython-plugins</a></p><hr><h1 id="future-plans">Future Plans</h1><p>Automate more things! I want to play with the idea of extending the player stats logging to include not only more information but way more advanced ability to view that information. Maybe even work with some of my data science friends to derive cool insights. Player progression over time and maybe even something like an <a href="https://dota2.gamepedia.com/Matchmaking_Rating">MMR</a> or try to guess their skill division.</p><p>I also want to play with the idea of having the <a href="https://developer.valvesoftware.com/wiki/SourceTV">SourceTV</a> camera directed by machine learning. How awesome would it be to have a computer know and show you where the big moments are. Basically can follow the action in the game so viewers can just sit back and watch as if a crew was doing all of it.</p><p>Add some feature to make the "pick up game" (pug) experience better. MMR for players to try to balance teams. Ability to just randomize teams. Ability to have a 2 captains pick players and assign them to teams.</p><p>Offer this as a cheap paid service for the Team Fortress community in general. Not sure how much I would charge per month; not looking to get rich or anything; but make my hosting costs into nothing.</p></div><footer class="wrapper post__footer"><ul class="post__tag"><li><a href="https://patcave.me/tags/gaming/">Gaming</a></li><li><a href="https://patcave.me/tags/computer-science/">Programming Stuff</a></li></ul></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://patcave.me/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://patcave.me/what-i-learned-from-making-a-discord-bot-from-scratch/" class="invert post__nav-link" rel="prev"><span>Previous</span> What I learned from making a Discord bot framework</a></div><div class="post__nav-next"><a href="https://patcave.me/learning-3d-modeling-for-video-games/" class="invert post__nav-link" rel="next"><span>Next</span> Learning 3D Modeling for TF2 </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://patcave.me/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav></main><footer class="footer"><div class="footer__copyright"><p>© Patrick Hennessy 2014 - 2022</p></div></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };</script><script defer="defer" src="https://patcave.me/assets/js/scripts.min.js?v=48e9576b9741cf2a93ab25c5689c9f5d"></script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="https://patcave.me/assets/js/photoswipe.min.js?v=b586a3bc288c989ecce7b81b48e35855"></script><script defer="defer" src="https://patcave.me/assets/js/photoswipe-ui-default.min.js?v=9952f77ca2b8fbc9449a268008ea8dee"></script><script>var initPhotoSwipeFromDOM=function(gallerySelector){var parseThumbnailElements=function(el){var thumbElements=el.childNodes,numNodes=thumbElements.length,items=[],figureEl,linkEl,size,item;for(var i=0;i<numNodes;i++){figureEl=thumbElements[i];if(figureEl.nodeType!==1){continue;}
          linkEl=figureEl.children[0];size=linkEl.getAttribute('data-size').split('x');item={src:linkEl.getAttribute('href'),w:parseInt(size[0],10),h:parseInt(size[1],10)};if(figureEl.children.length>1){item.title=figureEl.children[1].innerHTML;}
          if(linkEl.children.length>0){item.msrc=linkEl.children[0].getAttribute('src');}
          item.el=figureEl;items.push(item);}
          return items;};var closest=function closest(el,fn){return el&&(fn(el)?el:closest(el.parentNode,fn));};var onThumbnailsClick=function(e){e=e||window.event;e.preventDefault?e.preventDefault():e.returnValue=false;var eTarget=e.target||e.srcElement;var clickedListItem=closest(eTarget,function(el){return(el.tagName&&el.tagName.toUpperCase()==='FIGURE');});if(!clickedListItem){return;}
          var clickedGallery=clickedListItem.parentNode,childNodes=clickedListItem.parentNode.childNodes,numChildNodes=childNodes.length,nodeIndex=0,index;for(var i=0;i<numChildNodes;i++){if(childNodes[i].nodeType!==1){continue;}
          if(childNodes[i]===clickedListItem){index=nodeIndex;break;}
          nodeIndex++;}
          if(index>=0){openPhotoSwipe(index,clickedGallery);}
          return false;};var photoswipeParseHash=function(){var hash=window.location.hash.substring(1),params={};if(hash.length<5){return params;}
          var vars=hash.split('&');for(var i=0;i<vars.length;i++){if(!vars[i]){continue;}
          var pair=vars[i].split('=');if(pair.length<2){continue;}
          params[pair[0]]=pair[1];}
          if(params.gid){params.gid=parseInt(params.gid,10);}
          return params;};var openPhotoSwipe=function(index,galleryElement,disableAnimation,fromURL){var pswpElement=document.querySelectorAll('.pswp')[0],gallery,options,items;items=parseThumbnailElements(galleryElement);options={galleryUID:galleryElement.getAttribute('data-pswp-uid'),getThumbBoundsFn:function(index){var thumbnail=items[index].el.getElementsByTagName('img')[0],pageYScroll=window.pageYOffset||document.documentElement.scrollTop,rect=thumbnail.getBoundingClientRect();return{x:rect.left,y:rect.top+pageYScroll,w:rect.width};},
          mainClass:'pswp--dark',
          preload: [1,2],
          hideAnimationDuration:200,
          showAnimationDuration:0,
          bgOpacity: 0.7,
          showHideOpacity:true,
          closeOnScroll: true,
          arrowKeys: true,
          closeEl: true,
          captionEl: true,
          fullscreenEl: false,
          zoomEl: false,
          shareEl: false,
          counterEl: false,
          arrowEl: true,
          preloaderEl: true
          };if(fromURL){if(options.galleryPIDs){for(var j=0;j<items.length;j++){if(items[j].pid==index){options.index=j;break;}}}else{options.index=parseInt(index,10)-1;}}else{options.index=parseInt(index,10);}
          if(isNaN(options.index)){return;}
          if(disableAnimation){options.showAnimationDuration=0;}
          gallery=new PhotoSwipe(pswpElement,PhotoSwipeUI_Default,items,options);gallery.init();gallery.options.maxSpreadZoom = gallery.getZoomLevel();gallery.options.getDoubleTapZoom = function(isMouseClick, item) {return item.initialZoomLevel;};gallery.options.escKey=true;};var galleryElements=document.querySelectorAll(gallerySelector);for(var i=0,l=galleryElements.length;i<l;i++){galleryElements[i].setAttribute('data-pswp-uid',i+1);galleryElements[i].onclick=onThumbnailsClick;}
          var hashData=photoswipeParseHash();if(hashData.pid&&hashData.gid){openPhotoSwipe(hashData.pid,galleryElements[hashData.gid-1],true,true);}};window.addEventListener('load', function () {initPhotoSwipeFromDOM('.gallery');}, false);</script><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button><button class="pswp__button pswp__button--share" title="Share"></button><button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button><button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button><button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></body></html>